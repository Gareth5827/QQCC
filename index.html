<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Stats Tracker</title>
    <style>
        /* Basic styling for the page */
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .box {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            min-height: 100px;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .stat-box {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 3px;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .toggle-container {
            margin: 20px 0;
        }
        
        h1, h2 {
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Interactive Stats Tracker</h1>
    
    <!-- Toggle switches -->
    <div class="toggle-container">
        <label>
            <input type="checkbox" id="loreToggle"> Enable Lore
        </label>
        <label>
            <input type="checkbox" id="weirdWorldToggle"> Enable Weird World
        </label>
    </div>
    
    <!-- Reroll button -->
    <div style="text-align: center;">
        <button id="rerollButton">Reroll</button>
    </div>
    
    <!-- Results container -->
    <div class="container">
        <div>
            <h2>Weapon</h2>
            <div class="box" id="weaponBox"></div>
            
            <h2>Spell</h2>
            <div class="box" id="spellBox"></div>
            
            <h2>Passive</h2>
            <div class="box" id="passiveBox"></div>
        </div>
        
        <div>
            <h2>Item</h2>
            <div class="box" id="itemBox"></div>
            <h2>Bonuses</h2>
            <div class="box" id="profBox"></div>
            <h2>Lore</h2>
            <div class="box" id="loreBox"></div>
        </div>
    </div>
    
    <!-- Stats display -->
    <h2>Stats</h2>
    <div class="stats-container">
        <div>
            <div class="stat-box" id="endStat">END: 0</div>
            <div class="stat-box" id="insStat">INS: 0</div>
            <div class="stat-box" id="witStat">WIT: 0</div>
        </div>
        <div>
            <div class="stat-box" id="agiStat">AGI: 0</div>
            <div class="stat-box" id="allStat">ALL: 0</div>
            <div class="stat-box" id="pwrStat">PWR: 0</div>
        </div>
    </div>
    
    <!-- Attributes display -->
    <h2>Attributes</h2>
    <div class="stats-container">
        <div>
            <div class="stat-box" id="healthStat">Health: 23</div>
            <div class="stat-box" id="manaStat">Mana: 20</div>
            <div class="stat-box" id="manaRegenStat">Mana Regen: 7</div>
        </div>
        <div>
            <div class="stat-box" id="swiftnessStat">Swiftness: 10</div>
            <div class="stat-box" id="spiritStat">Spirit: 10</div>
            <div class="stat-box" id="advantageStat">Advantage: 0</div>
        </div>
    </div>

    <script>
        // Base attribute values
        const baseAttributes = {
            health: 23,
            mana: 20,
            manaRegen: 7,
            swiftness: 10,
            spirit: 10,
            advantage: 0
        };
        
        // Current stat values
        let stats = {
            END: 0,
            INS: 0,
            WIT: 0,
            AGI: 0,
            ALL: 0,
            PWR: 0
        };
        
        // Current attribute values (start with base)
        let attributes = JSON.parse(JSON.stringify(baseAttributes));
        
        // Lists of items, weapons, spells, etc.
        const weaponList = [
            "Sword", "Axe", "Bow", "Dagger", "Staff", 
            "Hammer", "Spear", "Crossbow", "Whip", "Scythe",
            // Add more weapons as needed (up to 59 or 70)
        ];
        
        const spellList = [
            "Fireball", "Ice Shard", "Lightning Bolt", "Heal", "Teleport",
            "Invisibility", "Summon Creature", "Charm", "Fear", "Polymorph",
            // Add more spells as needed
        ];
        
        const passiveList = [
            "Willpower", "Dodge", "Critical Strike", "Regeneration", "Resistance",
            "Reflection", "Absorption", "Precision", "Vampirism", "Immunity",
            // Add more passives as needed
        ];
        
        const itemList = [
            // Format: { name: "Item Name", statEffects: { stat: value }, attributeEffects: { attribute: value } }
            { name: "Chestplate", statEffects: { END: 2, AGI: -1 }, attributeEffects: { health: 3 } },
            { name: "Boots", statEffects: { AGI: 2 }, attributeEffects: { swiftness: 2 } },
            { name: "Helmet", statEffects: { WIT: 1 }, attributeEffects: { manaRegen: 1 } },
            { name: "Amulet", statEffects: { ALL: 1 }, attributeEffects: { spirit: 2 } },
            { name: "Ring", statEffects: { PWR: 1 }, attributeEffects: { advantage: 1 } },
            // Add more items as needed
        ];

        const profList = [
            "+1 Might +1 Stealth +1 Arcana",
            "+2 Might +1 Survival",
            "+1 Agility +1 Perception",
            "+2 Arcana +1 Might",
            // Add more professions as needed
        ];
        
        const loreList = [
            "You are a knight!",
            "You are a mage!",
            "You are a rogue!",
            "You are a cleric!",
            "You are a ranger!",
            // Add more lore as needed
        ];
        
        // Weird world additions (only available when toggle is on)
        const weirdWorldWeapons = [
            "Cosmic Blade", "Reality Warper", "Void Bow"
        ];
        
        const weirdWorldSpells = [
            "Black Hole", "Time Stop", "Dimension Door"
        ];
        
        const weirdWorldPassives = [
            "Quantum Entanglement", "Parallel Selves", "Probability Manipulation"
        ];
        
        const weirdWorldItems = [
            { name: "Singularity Core", statEffects: { ALL: 3 }, attributeEffects: { spirit: 5, advantage: 2 } },
            { name: "Dimensional Boots", statEffects: { AGI: 5 }, attributeEffects: { swiftness: 5 } }
        ];
        
        const weirdWorldLore = [
            "You are from another dimension!",
            "The laws of physics don't apply to you!",
            "You see through the veil of reality!"
        ];
        
        const weirdWorldProfList = [
            "+3 Quantum Physics +1 Reality Warping",
            "+2 Chronomancy +1 Dimensional Rifting",
            // Add more weird world professions
        ];
        
        // DOM elements
        const weaponBox = document.getElementById('weaponBox');
        const spellBox = document.getElementById('spellBox');
        const passiveBox = document.getElementById('passiveBox');
        const itemBox = document.getElementById('itemBox');
        const loreBox = document.getElementById('loreBox');
        const rerollButton = document.getElementById('rerollButton');
        const loreToggle = document.getElementById('loreToggle');
        const weirdWorldToggle = document.getElementById('weirdWorldToggle');
        
        // Stat display elements
        const endStat = document.getElementById('endStat');
        const insStat = document.getElementById('insStat');
        const witStat = document.getElementById('witStat');
        const agiStat = document.getElementById('agiStat');
        const allStat = document.getElementById('allStat');
        const pwrStat = document.getElementById('pwrStat');
        
        // Attribute display elements
        const healthStat = document.getElementById('healthStat');
        const manaStat = document.getElementById('manaStat');
        const manaRegenStat = document.getElementById('manaRegenStat');
        const swiftnessStat = document.getElementById('swiftnessStat');
        const spiritStat = document.getElementById('spiritStat');
        const advantageStat = document.getElementById('advantageStat');
        
        // Function to get a random number within a range
        function getRandomNumber(max, min = 0) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Function to reset all stats and attributes to base values
        function resetStatsAndAttributes() {
            // Reset stats
            stats = {
                END: 0,
                INS: 0,
                WIT: 0,
                AGI: 0,
                ALL: 0,
                PWR: 0
            };
            
            // Reset attributes to base values
            attributes = JSON.parse(JSON.stringify(baseAttributes));
            
            // Update stat displays
            updateStatDisplays();
        }
        
        // Function to update all stat displays
        function updateStatDisplays() {
            endStat.textContent = `END: ${stats.END > 0 ? '+' : ''}${stats.END}`;
            insStat.textContent = `INS: ${stats.INS > 0 ? '+' : ''}${stats.INS}`;
            witStat.textContent = `WIT: ${stats.WIT > 0 ? '+' : ''}${stats.WIT}`;
            agiStat.textContent = `AGI: ${stats.AGI > 0 ? '+' : ''}${stats.AGI}`;
            allStat.textContent = `ALL: ${stats.ALL > 0 ? '+' : ''}${stats.ALL}`;
            pwrStat.textContent = `PWR: ${stats.PWR > 0 ? '+' : ''}${stats.PWR}`;
            
            // Update attribute displays
            healthStat.textContent = `Health: ${attributes.health}`;
            manaStat.textContent = `Mana: ${attributes.mana}`;
            manaRegenStat.textContent = `Mana Regen: ${attributes.manaRegen}`;
            swiftnessStat.textContent = `Swiftness: ${attributes.swiftness}`;
            spiritStat.textContent = `Spirit: ${attributes.spirit}`;
            advantageStat.textContent = `Advantage: ${attributes.advantage}`;
        }
        
        // Function to apply stat changes (handles opposites)
        function applyStatChanges(statChanges) {
            for (const [stat, value] of Object.entries(statChanges)) {
                // Apply the stat change
                stats[stat] += value;
                
                // Apply opposite stat changes
                switch(stat) {
                    case 'END':
                        stats.ALL -= value;
                        break;
                    case 'ALL':
                        stats.END -= value;
                        break;
                    case 'AGI':
                        stats.INS += value;
                        break;
                    case 'INS':
                        stats.AGI += value;
                        break;
                    case 'PWR':
                        stats.WIT += value;
                        break;
                    case 'WIT':
                        stats.PWR += value;
                        break;
                }
            }
            
            // Update attributes based on stats
            attributes.health = baseAttributes.health + stats.END;
            attributes.mana = baseAttributes.mana + stats.INS;
            attributes.manaRegen = baseAttributes.manaRegen + stats.WIT;
            attributes.swiftness = baseAttributes.swiftness + stats.AGI;
            attributes.spirit = baseAttributes.spirit + stats.ALL;
            attributes.advantage = baseAttributes.advantage + stats.PWR;
        }
        
        // Function to apply attribute changes
        function applyAttributeChanges(attributeChanges) {
            for (const [attribute, value] of Object.entries(attributeChanges)) {
                attributes[attribute] += value;
            }
        }
        
        // Function to perform a reroll
        function reroll() {
            // Clear all boxes
            weaponBox.textContent = '';
            spellBox.textContent = '';
            passiveBox.textContent = '';
            itemBox.textContent = '';
            loreBox.textContent = '';
            profBox.textContent = '';
            
            // Reset stats and attributes
            resetStatsAndAttributes();
            
            // Determine the maximum index based on toggle
            const maxRegularIndex = 59; // Assuming you have 60 items (0-59)
            const maxWeirdWorldIndex = 69; // Assuming you have 70 items (0-69)
            
            const maxIndex = weirdWorldToggle.checked ? maxWeirdWorldIndex : maxRegularIndex;
            
            // Get two different random numbers
            let num1 = getRandomNumber(maxIndex);
            let num2 = getRandomNumber(maxIndex);
            
            // Ensure they're different
            while (num2 === num1) {
                num2 = getRandomNumber(maxIndex);
            }
            
            // Get items from lists
            const weapon1 = num1 < weaponList.length ? weaponList[num1] : "Unknown Weapon";
            const weapon2 = num2 < weaponList.length ? weaponList[num2] : "Unknown Weapon";
            
            const spell1 = num1 < spellList.length ? spellList[num1] : "Unknown Spell";
            const spell2 = num2 < spellList.length ? spellList[num2] : "Unknown Spell";
            
            const passive1 = num1 < passiveList.length ? passiveList[num1] : "Unknown Passive";
            const passive2 = num2 < passiveList.length ? passiveList[num2] : "Unknown Passive";
            
            const item1 = num1 < itemList.length ? itemList[num1] : { name: "Unknown Item" };
            const item2 = num2 < itemList.length ? itemList[num2] : { name: "Unknown Item" };
            
            const lore1 = num1 < loreList.length ? loreList[num1] : "Unknown Lore";
            const lore2 = num2 < loreList.length ? loreList[num2] : "Unknown Lore";
            
            // Get professions from lists
            const prof1 = num1 < profList.length ? profList[num1] : "+0 Bonus";
            const prof2 = num2 < profList.length ? profList[num2] : "+0 Bonus";
    
            // Get weird world professions if toggle is on
            if (weirdWorldToggle.checked) {
                if (num1 >= maxRegularIndex) {
                    const weirdIndex = num1 - maxRegularIndex;
                    if (weirdIndex < weirdWorldProfList.length) {
                        prof1 = weirdWorldProfList[weirdIndex];
                    }
                }
                if (num2 >= maxRegularIndex) {
                    const weirdIndex = num2 - maxRegularIndex;
                    if (weirdIndex < weirdWorldProfList.length) {
                        prof2 = weirdWorldProfList[weirdIndex];
                    }
                }
            }
    
            // Process and combine professions
            const combinedProfessions = combineProfessions(prof1, prof2);
            profBox.textContent = combinedProfessions;
            
            // Get weird world items if toggle is on and numbers are in that range
            if (weirdWorldToggle.checked) {
                if (num1 >= maxRegularIndex) {
                    const weirdIndex = num1 - maxRegularIndex;
                    if (weirdIndex < weirdWorldWeapons.length) weapon1 = weirdWorldWeapons[weirdIndex];
                    if (weirdIndex < weirdWorldSpells.length) spell1 = weirdWorldSpells[weirdIndex];
                    if (weirdIndex < weirdWorldPassives.length) passive1 = weirdWorldPassives[weirdIndex];
                    if (weirdIndex < weirdWorldItems.length) item1 = weirdWorldItems[weirdIndex];
                    if (weirdIndex < weirdWorldLore.length) lore1 = weirdWorldLore[weirdIndex];
                }
                
                if (num2 >= maxRegularIndex) {
                    const weirdIndex = num2 - maxRegularIndex;
                    if (weirdIndex < weirdWorldWeapons.length) weapon2 = weirdWorldWeapons[weirdIndex];
                    if (weirdIndex < weirdWorldSpells.length) spell2 = weirdWorldSpells[weirdIndex];
                    if (weirdIndex < weirdWorldPassives.length) passive2 = weirdWorldPassives[weirdIndex];
                    if (weirdIndex < weirdWorldItems.length) item2 = weirdWorldItems[weirdIndex];
                    if (weirdIndex < weirdWorldLore.length) lore2 = weirdWorldLore[weirdIndex];
                }
            }
            
            // Display results
            weaponBox.textContent = `${weapon1} / ${weapon2}`;
            spellBox.textContent = `${spell1} / ${spell2}`;
            passiveBox.textContent = `${passive1} / ${passive2}`;
            itemBox.textContent = `${item1.name} / ${item2.name}`;
            
            // Display lore if toggle is on
            if (loreToggle.checked) {
                loreBox.textContent = `${lore1}\n\n${lore2}`;
            }
            
            // Apply stat and attribute changes from items
            if (item1.statEffects) applyStatChanges(item1.statEffects);
            if (item1.attributeEffects) applyAttributeChanges(item1.attributeEffects);
            
            if (item2.statEffects) applyStatChanges(item2.statEffects);
            if (item2.attributeEffects) applyAttributeChanges(item2.attributeEffects);
            
            // Update displays
            updateStatDisplays();
        }

                // New function to combine and format professions
        function combineProfessions(prof1, prof2) {
            const skillMap = new Map();
            
            // Helper function to parse and add skills
            function parseSkills(profText) {
                const skillMatches = profText.matchAll(/\+(\d+) (\w+)/g);
                for (const match of skillMatches) {
                    const value = parseInt(match[1]);
                    const skill = match[2];
                    skillMap.set(skill, (skillMap.get(skill) || 0) + value);
                }
            }
            
            // Parse both profession strings
            parseSkills(prof1);
            parseSkills(prof2);
            
            // Convert to array and sort
            const sortedSkills = Array.from(skillMap.entries())
                .sort((a, b) => {
                    // First sort by value (descending)
                    if (b[1] !== a[1]) return b[1] - a[1];
                    // Then sort alphabetically
                    return a[0].localeCompare(b[0]);
                });
            
            // Format the output
            return sortedSkills.map(([skill, value]) => `+${value} ${skill}`).join(', ');
        }
        
        // Event listener for reroll button
        rerollButton.addEventListener('click', reroll);
        
        // Initial roll
        reroll();
    </script>
</body>
</html>
