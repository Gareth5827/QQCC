<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickQuest Character Creator</title>
    <style>
        /* Basic styling for the page */
        body {
             font-family: Arial, sans-serif;
             max-width: 1000px;
             margin: 0 auto;
             padding: 20px;
             background-color: #f5f5f5;
         }
 
         .container {
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 30px;
         }
 
         .box {
             background-color: white;
             border: 1px solid #ddd;
             border-radius: 5px;
             padding: 15px;
             margin-bottom: 20px;
             min-height: 100px;
         }
        
        .stats-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .stat-box {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 3px;
        }
        
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        
        button:hover {
            background-color: #45a049;
        }
        
        .toggle-container {
            margin: 20px 0;
        }
        
        h1, h2 {
            color: #333;
        }

        /* Updated Manager Section CSS */
        .manager-section {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .manager-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px;
            justify-content: center;
        }
        
        .manager-input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 18px;
            text-align: center;
        }
        
        .manager-button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 18px;
        }
        
        .manager-button:hover {
            background-color: #45a049;
        }
        
        .manager-toggles {
            display: flex;
            gap: 15px;
            justify-content: center;
            font-size: 18px;
        }
        
        .manager-toggles input[type="radio"] {
            transform: scale(1.3);
            margin-right: 5px;
        }

        #universalButtons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        #universalButtons .action-button {
            min-width: 120px;
        }

        .stats-attributes-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
                /* Dice Roller CSS */
        .dice-roller-section {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .dice-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
        }
        
        .dice-input {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .dice-input label {
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .dice-input-field {
            width: 50px;
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        
        .dice-roll-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 15px;
        }
        
        .dice-roll-button:hover {
            background-color: #45a049;
        }
        
        .dice-result-box {
            display: inline-block;
            background-color: #f0f0f0;
            padding: 10px 20px;
            border-radius: 3px;
            font-size: 18px;
            min-width: 100px;
            text-align: center;
        }
                /* Button Layer Styles */
        .button-layer {
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 15px;
        }
        
        .button-layer h3 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #444;
        }
        
        .button-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .action-button {
            background-color: #4CAF50;
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            min-width: 120px;
        }
        
        .action-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        .action-button.weapon {
            background-color: #2196F3;
        }
        
        .action-button.spell {
            background-color: #9C27B0;
        }
        
        .action-button.passive {
            background-color: #FF9800;
        }
    </style>
</head>
<body>
    <h1>QuickQuest Character Creator</h1>
    
    <!-- Toggle switches -->
    <div class="toggle-container">
        <label>
            <input type="checkbox" id="loreToggle"> Enable Lore
        </label>
        <label>
            <input type="checkbox" id="weirdWorldToggle"> Enable Weird World
        </label>
    </div>
    
    <!-- Reroll button -->
    <div style="text-align: center;">
        <button id="rerollButton">Reroll</button>
    </div>
    
    <!-- Results container -->
    <div class="container">
        <div>
            <h2>Weapon</h2>
            <div class="box" id="weaponBox"></div>
            
            <h2>Spell</h2>
            <div class="box" id="spellBox"></div>
            
            <h2>Passive</h2>
            <div class="box" id="passiveBox"></div>
        </div>
        
        <div>
            <h2>Item</h2>
            <div class="box" id="itemBox"></div>
            <h2>Bonuses</h2>
            <div class="box" id="profBox"></div>
            <h2>Lore</h2>
            <div class="box" id="loreBox"></div>
        </div>
    </div>
    
        <!-- Stats and Attributes container -->
        <div class="stats-attributes-container">
            <!-- Stats display -->
            <div>
                <h2>Stats</h2>
                <div class="stats-container">
                    <div>
                        <div class="stat-box" id="endStat">END: 0</div>
                        <div class="stat-box" id="insStat">INS: 0</div>
                        <div class="stat-box" id="witStat">WIT: 0</div>
                    </div>
                    <div>
                        <div class="stat-box" id="allStat">ALL: 0</div>
                        <div class="stat-box" id="agiStat">AGI: 0</div>
                        <div class="stat-box" id="pwrStat">PWR: 0</div>
                    </div>
                </div>
                
                <!-- Attributes display -->
                <h2>Attributes</h2>
                <div class="stats-container">
                    <div>
                        <div class="stat-box" id="healthStat">Health: 0 / 0</div>
                        <div class="stat-box" id="manaStat">Mana: 0 / 0</div>
                        <div class="stat-box" id="manaregenStat">Mana Regen: 0</div>
                    </div>
                    <div>
                        <div class="stat-box" id="spiritStat">Spirit: 0</div>
                        <div class="stat-box" id="swiftnessStat">Swiftness: 0</div>
                        <div class="stat-box" id="advantageStat">Advantage: 0</div>
                    </div>
                </div>
            </div>
            
            <!-- Manager Section -->
            <div class="manager-section">
                <div class="manager-controls">
                    <button class="manager-button" id="gainButton">Gain</button>
                    <input type="number" class="manager-input" id="resourceInput" min="0" value="0">
                    <button class="manager-button" id="loseButton">Lose</button>
                </div>
                <div class="manager-toggles">
                    <label>
                        <input type="radio" name="resourceType" id="healthToggle" checked> Health
                    </label>
                    <label>
                        <input type="radio" name="resourceType" id="manaToggle"> Mana
                    </label>
                    <label>
                        <input type="radio" name="resourceType" id="tpToggle"> TP
                    </label>
                </div>
                    <!-- TP Display -->
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="display: inline-block; background-color: #f0f0f0; padding: 8px 15px; border-radius: 3px; font-size: 18px;">
                        TP: <span id="tpDisplay">6</span>/6
                    </div>
                    <div style="display: inline-block; background-color: #f0f0f0; padding: 8px 15px; border-radius: 3px; font-size: 18px; margin-left: 10px;">
                        Mana: <span id="manaDisplay">0</span>/<span id="maxManaDisplay">0</span>
                    </div>
                </div>
                
                <!-- Button Layers -->
                <div class="button-layer" id="layer1">
                    <h3>Roll 1 Actions</h3>
                    <div class="button-container" id="layer1Buttons"></div>
                </div>
                
                <div class="button-layer" id="layer2">
                    <h3>Roll 2 Actions</h3>
                    <div class="button-container" id="layer2Buttons"></div>
                </div>

                <div class="button-layer" id="universalActions">
                    <h3>Universal Actions</h3>
                    <div class="button-container" id="universalButtons"></div>
                </div>
                
                <!-- End Turn Button -->
                <div style="text-align: center; margin-top: 20px;">
                    <button id="endTurnButton" class="manager-button">End Turn</button>
                </div>
            </div>
        </div> <!-- Closing stats-attributes-container div -->
    
        <!-- Dice Roller Section -->
    <div class="dice-roller-section" style="margin-top: 30px;">
        <h2>Dice Roller</h2>
        <div class="dice-container">
            <div class="dice-input">
                <label>D4</label>
                <input type="number" min="0" value="0" id="d4Input" class="dice-input-field">
            </div>
            <div class="dice-input">
                <label>D6</label>
                <input type="number" min="0" value="0" id="d6Input" class="dice-input-field">
            </div>
            <div class="dice-input">
                <label>D8</label>
                <input type="number" min="0" value="0" id="d8Input" class="dice-input-field">
            </div>
            <div class="dice-input">
                <label>D10</label>
                <input type="number" min="0" value="0" id="d10Input" class="dice-input-field">
            </div>
            <div class="dice-input">
                <label>D12</label>
                <input type="number" min="0" value="0" id="d12Input" class="dice-input-field">
            </div>
            <div class="dice-input">
                <label>D20</label>
                <input type="number" min="0" value="0" id="d20Input" class="dice-input-field">
            </div>
        </div>
        <div style="text-align: center; margin-top: 15px;">
            <button id="rollButton" class="dice-roll-button">Roll</button>
            <div class="dice-result-box" id="diceResultBox">Total: 0</div>
        </div>
    </div>

    <!-- Image Section -->
    <div class="image-section" style="margin-top: 30px;">
        <h2>Character Images</h2>
        <div class="image-grid">
            <div class="image-row">
                <img id="image1" src="" alt="Image 1" style="width: 245px; height: 245px; object-fit: cover;">
                <img id="image2" src="" alt="Image 2" style="width: 245px; height: 245px; object-fit: cover;">
                <img id="image3" src="" alt="Image 3" style="width: 245px; height: 245px; object-fit: cover;">
                <img id="image4" src="" alt="Image 4" style="width: 245px; height: 245px; object-fit: cover;">
            </div>
            <div class="image-row">
                <img id="image5" src="" alt="Image 5" style="width: 245px; height: 245px; object-fit: cover;">
                <img id="image6" src="" alt="Image 6" style="width: 245px; height: 245px; object-fit: cover;">
                <img id="image7" src="" alt="Image 7" style="width: 245px; height: 245px; object-fit: cover;">
                <img id="image8" src="" alt="Image 8" style="width: 245px; height: 245px; object-fit: cover;">
            </div>
        </div>
    </div>

    <script>
        // Base attribute values
        const baseAttributes = {
            health: 23,
            mana: 20,
            manaregen: 7,
            swiftness: 10,
            spirit: 10,
            advantage: 0
        };
        
        // Current stat values
        let stats = {
            END: 0,
            INS: 0,
            WIT: 0,
            AGI: 0,
            ALL: 0,
            PWR: 0
        };
        
        // Current attribute values (start with base)
        let attributes = JSON.parse(JSON.stringify(baseAttributes));
        
        // Current and max health/mana values
        let currentHealth = 0;
        let maxHealth = 0;
        let currentMana = 0;
        let maxMana = 0;
        // Resource Manager Variables
        let currentTP = 6;
        let weaponUsed = false;
        let currentRollNumbers = [0, 0];
        
        // DOM Elements for Resource Manager
        const tpDisplay = document.getElementById('tpDisplay');
        const manaDisplay = document.getElementById('manaDisplay');
        const maxManaDisplay = document.getElementById('maxManaDisplay');
        const layer1Buttons = document.getElementById('layer1Buttons');
        const layer2Buttons = document.getElementById('layer2Buttons');
        const endTurnButton = document.getElementById('endTurnButton');

        // Image mapping for each slot
        const slotImageMap = {
            0: ["VolcanicEruption", "HellishEmbers", "Spark", "DemonicCharm"],
            1: ["AquaticSurge", "Tidebreaker", "SagesCharm", "AquamancersBracelet"],
            2: ["SnakeskinWhip", "Blowdart", "RottingTouch", "HuntersArmlet"],
            3: ["Tsunami", "WaterAmulet", "AbyssalClaw", "SeafolkTiara"],
            4: ["AngelSword", "FlintlockPouch", "CullOfTheCharred", "AngelicChestplate"],
            5: ["HellBlade", "DemonicExtinguish", "SinisterLordsRitual", "UnderworldGemstone"],
            6: ["AngelStaff", "AngelPalm", "Sunbeam", "CloudstridersCharm"],
            7: ["DraconicBarrier", "Dragonhide", "DragonBreath", "DragonscaleChestplate"],
            8: ["WyvernsNail", "ToxinCharm", "PlagueKiss", "DraconicCloak"],
            9: ["StoneWall", "BoulderToss", "HeavyHitter", "GeomancersChestplate"],
            10: ["ArcaneBolt", "ArchmagesStaff", "ArcaneMastery", "ArchmagesAmulet"],
            11: ["RayOfSunshine", "HolyRay", "Empower", "HolyLocket"],
            12: ["PetrifyingGaze", "EnergySyphon", "CullOfTheMeek", "ShamansGarb"],
            13: ["GoldenBroadsword", "RampagersJavelin", "Brutality", "RampagersHelmet"],
            14: ["Thunderbolt", "TwinBolt", "FierceGust", "ElectromancersHelmet"],
            15: ["Bloodlust", "BeheadingAxe", "Taunt", "GladiatorsCape"],
            16: ["UnderworldCurse", "InfernalShove", "BurningScimitar", "InfernalCharm"],
            17: ["CrimsonBlade", "ReapersBlessing", "ViolentStrike", "WarlordsLegGuards"],
            18: ["ImpsTrident", "ImpsAgility", "HellShard", "DarkOmenOfProtection"],
            19: ["MaceOfTheSerpent", "DaggerOfTheSunken", "AquaticChains", "WaveskipperBoots"],
            20: ["NauseousGale", "MysticFang", "BlessingOfTheWise", "WizardsRobe"],
            21: ["CurseOfTheWartorn", "SpiritShred", "AuraOfInsanity", "ShamansWarpaint"],
            22: ["BlessingOfTheMountain", "StonePillar", "StoneWarhammer", "DwarvenWarHelm"],
            23: ["SoulReaver", "HailAmulet", "ArcaneFerocity", "PriestsNecklace"],
            24: ["MoltenLace", "SunInABottle", "BlessingOfTheSun", "DancersArmlet"],
            25: ["Claymore", "WrathOfTheHoly", "Swordplay", "KnightsArmour"],
            26: ["HellborneResistance", "InfernalScream", "HellishCharge", "OldGodsGarb"],
            27: ["SinisterAura", "SinisterOrb", "BlindingEssence", "DarkIronArmour"],
            28: ["Crossbow", "PoisonTip", "Beartrap", "WildArmlet"],
            29: ["OrcishGreataxe", "HonedStrike", "HuntersFerocity", "BerzerkersChestplate"],
            30: ["LightningStaff", "ElectroGrid", "ForkedLightning", "RaindancersHeadband"],
            31: ["HarshJudgement", "EyeOfAerid", "ClawOfAerid", "DarkPriestsCrystalEye"],
            32: ["FuryGauntlet", "Gladiator", "FierceTackle", "GladiatorsWarpaint"],
            33: ["CultistsDagger", "MysticStrike", "CultistsCrossbow", "BandOfNasmanai"],
            34: ["BruteShove", "TitansBarrier", "Headbutt", "TitanBracelet"],
            35: ["LightningBomb", "MysticPush", "RuneOfWisdom", "SacrificersGauntlet"],
            36: ["PlagueCloud", "VenomWave", "Necrotic", "VenomancersHood"],
            37: ["CharredQuarterstaff", "JungleSpear", "OceanboundFlail", "ElementalistsRing"],
            48: ["Warpath", "HorrificForesight", "WeaponMastery", "SpikedHandwraps"],
            39: ["RiseFromTheDead", "WhispersOfTheDamned", "HandOfTheCrypt", "TombShard"],
            40: ["SpiritArmour", "WarhammerOfTheDead", "GraveDust", "GravediggersPendant"],
            41: ["Torpedo", "RingWave", "Waveblade", "WiseAmulet"],
            42: ["WartornStaff", "Warpath", "EssencePrison", "ForbiddenCrown"],
            43: ["Tremor", "Warhammer", "HeavyHanded", "BuriedGauntlet"],
            44: ["FreezingTomb", "IcyWind", "NorthernWisdom", "FrostbornBracelet"],
            45: ["HolyStaff", "BlessingOfProtection", "RayOfRetribution", "PriestsRobe"],
            46: ["HonourOfAlliance", "BondOfFaith", "RoyalCharge", "KingsCloak"],
            47: ["CloakAndDagger", "SpiritBlade", "MindBreaker", "VeilOfShadows"],
            48: ["SteelArrow", "Hasted", "RogueTactics", "SkinningKnife"],
            49: ["GreatCrossbow", "Volley", "Sharpshot", "GreatRoguesRegalia"],
            50: ["RitualShield", "ShieldSweep", "PowerDash", "ArmletOfTheSacrificed"],
            51: ["Pummel", "JusticeLeap", "Rampage", "DarkIronGauntlets"],
            52: ["HuntersBow", "CombatRoll", "StraightShot", "DruidsSatchel"],
            53: ["DarkPalm", "DarkRush", "Facebreaker", "DarkLordsHeadband"],
            54: ["HeightenedSenses", "ManaLeak", "EvilSpike", "CryptbornNecklace"],
            55: ["Barrier", "Charge", "Taunt", "MinotaurHorn"],
            56: ["ScimitarOfTheDarkKnighthood", "DarkPact", "Cheapshot", "HelmetOfTheDarkKnighthood"],
            57: ["SuckerPunch", "Wrath", "Heartseeker", "GladiatorsHandwraps"],
            58: ["LightningBeam", "Zip", "Minibolt", "BraceletOfTheLightningMonk"],
            59: ["BoneShatterer", "Bloodletter", "BattleLunge", "GreatBerzerkersCrown"]
        };
                // Dice roller elements
        const d4Input = document.getElementById('d4Input');
        const d6Input = document.getElementById('d6Input');
        const d8Input = document.getElementById('d8Input');
        const d10Input = document.getElementById('d10Input');
        const d12Input = document.getElementById('d12Input');
        const d20Input = document.getElementById('d20Input');
        const rollButton = document.getElementById('rollButton');
        const diceResultBox = document.getElementById('diceResultBox');

        // Function to update resource displays
        function updateResourceDisplays() {
            tpDisplay.textContent = currentTP;
            manaDisplay.textContent = currentMana;
            maxManaDisplay.textContent = maxMana;
        }
        
        function parseActionCosts(text) {
            // Handle both formats: "[2 TP, 6 Mana]" and "[6 Mana] OR [2 TP]"
            const tpMatch = text.match(/\[(\d+) TP(?:,|\]| OR)/); // Updated regex
            const manaMatch = text.match(/(\d+) Mana(?:,|\]| OR)/);
            
            return {
                tpCost: tpMatch ? parseInt(tpMatch[1]) : 0,
                manaCost: manaMatch ? parseInt(manaMatch[1]) : 0,
                isWeapon: text.includes('(Weapon)')
            };
        }
        
        // Function to create action buttons
        function createActionButtons() {
            // Clear existing buttons
            layer1Buttons.innerHTML = '';
            layer2Buttons.innerHTML = '';
            
            // Create buttons for layer 1 (first roll number)
            createButtonsForLayer(currentRollNumbers[0], layer1Buttons);
            
            // Create buttons for layer 2 (second roll number)
            createButtonsForLayer(currentRollNumbers[1], layer2Buttons);
            
            // Update button states
            updateButtonStates();
        }
        
        function createButtonsForLayer(rollNumber, container) {
            // Clear previous buttons (if any)
            container.innerHTML = '';
        
            // Process Weapon if available
            if (weaponList[rollNumber]) {
                const weaponTexts = weaponList[rollNumber].split(/\s{3,}/); // Split by three or more spaces
                weaponTexts.forEach(weaponText => {
                    if (weaponText.trim()) { // Only process if not empty
                        const weaponName = weaponText.split(':')[0].trim();
                        const costs = parseActionCosts(weaponText);
                        
                        const btn = document.createElement('button');
                        btn.className = 'action-button weapon';
                        btn.textContent = `⚔️ ${weaponName}`;
                        btn.dataset.tpCost = costs.tpCost;
                        btn.dataset.manaCost = costs.manaCost;
                        btn.dataset.isWeapon = 'true';
                        btn.title = weaponText; // Show full description on hover
                        
                        btn.addEventListener('click', () => {
                            useAction(costs.tpCost, costs.manaCost, true);
                            updateResourceDisplays();
                            updateButtonStates();
                        });
                        
                        container.appendChild(btn);
                    }
                });
            }
        
            // Process Spell if available
            if (spellList[rollNumber]) {
                const spellTexts = spellList[rollNumber].split(/\s{3,}/); // Split by three or more spaces
                spellTexts.forEach(spellText => {
                    if (spellText.trim()) { // Only process if not empty
                        const spellName = spellText.split(':')[0] || spellText.split(']')[0].trim();
                        const costs = parseActionCosts(spellText);
                        
                        const btn = document.createElement('button');
                        btn.className = 'action-button spell';
                        btn.textContent = `✨ ${spellName}`;
                        btn.dataset.tpCost = costs.tpCost;
                        btn.dataset.manaCost = costs.manaCost;
                        btn.dataset.isWeapon = 'false';
                        btn.title = spellText;
                        
                        btn.addEventListener('click', () => {
                            useAction(costs.tpCost, costs.manaCost, false);
                            updateResourceDisplays();
                            updateButtonStates();
                        });
                        
                        container.appendChild(btn);
                    }
                });
            }
        
            // Process Passive (display only)
            if (passiveList[rollNumber]) {
                const passiveTexts = passiveList[rollNumber].split(/\s{3,}/); // Split by three or more spaces
                passiveTexts.forEach(passiveText => {
                    if (passiveText.trim()) { // Only process if not empty
                        const passiveName = passiveText.split(':')[0] || passiveText;
                        
                        const btn = document.createElement('button');
                        btn.className = 'action-button passive';
                        btn.textContent = `🛡️ ${passiveName}`;
                        btn.disabled = true; // Passives are automatic
                        btn.title = passiveText;
                        
                        container.appendChild(btn);
                    }
                });
            }
        }
        
        // Function to use an action (deduct costs)
        function useAction(tpCost, manaCost, isWeapon) {
            currentTP = Math.max(0, currentTP - tpCost);
            currentMana = Math.max(0, currentMana - manaCost);
            
            if (isWeapon) {
                weaponUsed = true;
            }
        }
        
        // Function to update button states (enable/disable based on resources)
        function updateButtonStates() {
            const buttons = document.querySelectorAll('.action-button');
            
            buttons.forEach(button => {
                const tpCost = parseInt(button.dataset.tpCost) || 0;
                const manaCost = parseInt(button.dataset.manaCost) || 0;
                const isWeapon = button.dataset.isWeapon === 'true';
                
                // Disable if:
                // 1. Not enough TP
                // 2. Not enough Mana
                // 3. It's a weapon and weaponUsed is true
                button.disabled = 
                    currentTP < tpCost || 
                    currentMana < manaCost || 
                    (isWeapon && weaponUsed);
            });
        }
        
        // Function to end turn
        function endTurn() {
            // Reset TP and weapon usage
            currentTP = 6;
            weaponUsed = false;
            
            // Regen mana
            currentMana = Math.min(maxMana, currentMana + attributes.manaregen);
            
            // Update displays and buttons
            updateResourceDisplays();
            updateStatDisplays();
            updateButtonStates();
        }
        
        // Event listener for end turn button
        endTurnButton.addEventListener('click', endTurn);

        
        // Function to roll a single die
        function rollDie(sides, count) {
            const results = [];
            for (let i = 0; i < count; i++) {
                results.push(Math.floor(Math.random() * sides) + 1);
            }
            return results;
        }
        
        // Function to handle dice rolling
        function rollDice() {
            console.log("--- Dice Roller Debug ---");
            
            // Get input values
            const d4Count = parseInt(d4Input.value) || 0;
            const d6Count = parseInt(d6Input.value) || 0;
            const d8Count = parseInt(d8Input.value) || 0;
            const d10Count = parseInt(d10Input.value) || 0;
            const d12Count = parseInt(d12Input.value) || 0;
            const d20Count = parseInt(d20Input.value) || 0;
            
            console.log("Input counts:", {
                d4: d4Count,
                d6: d6Count,
                d8: d8Count,
                d10: d10Count,
                d12: d12Count,
                d20: d20Count
            });
            
            // Roll dice
            const d4Results = rollDie(4, d4Count);
            const d6Results = rollDie(6, d6Count);
            const d8Results = rollDie(8, d8Count);
            const d10Results = rollDie(10, d10Count);
            const d12Results = rollDie(12, d12Count);
            const d20Results = rollDie(20, d20Count);
            
            console.log("Roll results:", {
                d4: d4Results,
                d6: d6Results,
                d8: d8Results,
                d10: d10Results,
                d12: d12Results,
                d20: d20Results
            });
            
            // Calculate totals
            const d4Total = d4Results.reduce((sum, val) => sum + val, 0);
            const d6Total = d6Results.reduce((sum, val) => sum + val, 0);
            const d8Total = d8Results.reduce((sum, val) => sum + val, 0);
            const d10Total = d10Results.reduce((sum, val) => sum + val, 0);
            const d12Total = d12Results.reduce((sum, val) => sum + val, 0);
            const d20Total = d20Results.reduce((sum, val) => sum + val, 0);
            
            const grandTotal = d4Total + d6Total + d8Total + d10Total + d12Total + d20Total;
            
            console.log("Totals:", {
                d4: d4Total,
                d6: d6Total,
                d8: d8Total,
                d10: d10Total,
                d12: d12Total,
                d20: d20Total,
                grandTotal: grandTotal
            });
            
            // Build result text
            let resultText = `Total: ${grandTotal}`;
            
            // Add individual rolls if any were made
            if (grandTotal > 0) {
                resultText += "<br><small>";
                const parts = [];
                
                if (d4Results.length > 0) parts.push(`D4: ${d4Results.join(', ')}`);
                if (d6Results.length > 0) parts.push(`D6: ${d6Results.join(', ')}`);
                if (d8Results.length > 0) parts.push(`D8: ${d8Results.join(', ')}`);
                if (d10Results.length > 0) parts.push(`D10: ${d10Results.join(', ')}`);
                if (d12Results.length > 0) parts.push(`D12: ${d12Results.join(', ')}`);
                if (d20Results.length > 0) parts.push(`D20: ${d20Results.join(', ')}`);
                
                resultText += parts.join(' | ');
                resultText += "</small>";
            }
            
            // Update result box
            diceResultBox.innerHTML = resultText;
            
            // Reset all input fields to 0
            d4Input.value = '0';
            d6Input.value = '0';
            d8Input.value = '0';
            d10Input.value = '0';
            d12Input.value = '0';
            d20Input.value = '0';
        }
        
        // Event listener for roll button
        rollButton.addEventListener('click', rollDice);

        // Function to set image with rare chance
        function setImageWithRareChance(elementId, imageName) {
            const imgElement = document.getElementById(elementId);
            const isRare = Math.random() < 0.01; // 1% chance for rare
            
            if (isRare) {
                // Try rare image first
                const rareImagePath = `Images/RareImages/{imageName}.png`;
                imgElement.onerror = function() {
                    // If rare image fails, try normal image
                    const normalImagePath = `Images/${imageName}.png`;
                    imgElement.src = normalImagePath;
                    imgElement.onerror = function() {
                        // If normal image fails, use null image
                        imgElement.src = "Images/NullImage.png";
                    };
                };
                imgElement.src = rareImagePath;
            } else {
                // Try normal image
                const normalImagePath = `Images/${imageName}.png`;
                imgElement.onerror = function() {
                    // If normal image fails, use null image
                    imgElement.src = "Images/NullImage.png";
                };
                imgElement.src = normalImagePath;
            }
        }
        
        // Function to update images based on slots
        function updateImages(slot1, slot2) {
            // Get images for first slot
            const slot1Images = slotImageMap[slot1] || ["NullImage", "NullImage", "NullImage", "NullImage"];
            setImageWithRareChance("image1", slot1Images[0]);
            setImageWithRareChance("image2", slot1Images[1]);
            setImageWithRareChance("image3", slot1Images[2]);
            setImageWithRareChance("image4", slot1Images[3]);
            
            // Get images for second slot
            const slot2Images = slotImageMap[slot2] || ["NullImage", "NullImage", "NullImage", "NullImage"];
            setImageWithRareChance("image5", slot2Images[0]);
            setImageWithRareChance("image6", slot2Images[1]);
            setImageWithRareChance("image7", slot2Images[2]);
            setImageWithRareChance("image8", slot2Images[3]);
        }
        
        // Lists of items, weapons, spells, etc.
const weaponList = [
    // 10
    "",
    // 11-12
    "", "",
    // 13
    "Water amulet: (Weapon) Force all units in a 10 foot range to make an END save against you, any unit that fails is knocked outside of the range [1 TP] OR [8 Mana]",
    // 14
    "Angel sword: (Weapon) [Attack] [Enemy] [10 FT] Deal 7 + (2 * PWR) damage [2 TP]",
    // 15
    "Hell blade: (Weapon) [Spell] [Enemy] [10 FT] Deal 1D6 Fire damage + 1D4 Magic damage, if you have 5+ INS, deal an additional 1D6 Dark damage [2 TP]",
    // 16
    "Angel staff: (Weapon) [Spell] [Enemy] [15 FT] Deal 1D8 + END Magic damage, you may boost this action for 5 mana to heal yourself for 2 + END health [2 TP]",
    // 17-18
    "", "",
    // 19
    "",
    // 20
    "Archmage's staff: (Weapon) [Spell] [Enemy] [15 FT] Deal 3 + INS mod Magic damage [1 TP]",
    // 21-22
    "", "",
    // 23
    "Golden broadsword: (Weapon) [Attack] [Enemy] [10 FT] Deal 2D6 + (3 * PWR) [3 TP]",
    // 24-25
    "", "",
    // 26
    "Burning scimitar: (Weapon) [Spell] [Enemy] [10 FT] Target takes (INS + WIT) Fire damage [2 TP]",
    // 27
    "",
    // 28
    "Imps trident: (Weapon) [Attack] [Enemy] [10 FT] Deal 3 + 1D8 + AGI damage, you may boost this action for 5 Mana to use it again for free [2 TP]",
    // 29
    "Mace of the serpent: (Weapon) [Water] [Spell] [Ally] [Enemy] [10 FT] Deal 1D10 + INS Magic damage, you may attack an ally and remove a debuff instead of dealing damage [2 TP]   Dagger of the sunken: (Weapon) [Spell] [Enemy] [10 FT] Deal 1D6 + AGI Magic damage [1 TP]",
    // 30-31
    "", "",
    // 32
    "Stone warhammer (Weapon) [Attack] [Enemy] [15 FT] Deal 4D8 + (2 * PWR) damage [4 TP]",
    // 33
    "Soul reaver: (Weapon) [Spell] [Enemy] [10 FT] Deal 1D8 + WIT Dark damage, you may boost this action for 10 Mana to deal an additional 2D6 Dark damage [2 TP]",
    // 34
    "Molten lace: (Weapon) [Attack] [Enemy] [15 FT] Deal 1 + 1D4 + ALL Fire damage [1 TP]",
    // 35
    "Claymore: (Weapon) [Attack] [Enemy] [10 FT] Deal 1D4 + 9 [2 TP]",
    // 36-37
    "", "",
    // 38
    "Crossbow: [Attack] [Enemy] [20 FT] 5 + 1D10 damage [2 TP]",
    // 39
    "Orcish greataxe: [Attack] [Enemy] [10 FT] Deal 15 + 1D12 + (3 * PWR) [5 TP]",
    // 40
    "Lighting staff: (Weapon) [Spell] [Enemy] [15 FT] Deal 1D8 + INS Magic damage, if there is an enemy in a 10 FT range of the target, they take equal damage [2 TP]",
    // 41
    "",
    // 42
    "Fury gauntlet: (Weapon) [Attack] [Enemy] [10 FT] Make two attack rolls, any that hit deal 1D6 + PWR damage [2 TP]",
    // 43
    "Cultists dagger: (Weapon) [Attack] [Enemy] [5 FT] Deal 1D6 + AGI damage [1 TP]   Cultists crossbow: (Weapon) [Attack] [Enemy] [25 FT] Deal 1D10 + AGI [2 TP]",
    // 44-46
    "", "", "",
    // 47
    "Charred quarterstaff: (Weapon) [Fire] [Attack] [Enemy] [10 FT] Deal 8 + (2 * PWR) Fire damage [2 TP]   Jungle spear: (Weapon) [Poison] [Attack] [Enemy] [10 FT] Deal 2D4 + AGI Poison damage [2 TP]   Oceanbound flail: (Weapon) [Water] [Attack] [Enemy] [10 FT] Deal 1D12 + ALL Magic damage [2 TP]",
    // 48
    "",
    // 49
    "Hand of the crypt: (Weapon) [Spell] [Enemy] [15 FT] Deal 1D6 + WIT Dark damage and force the target to make an END save, on fail they deal 3D4 less damage on their next [Attack] [2 TP] OR [1 TP, 10 Mana]",
    // 50-51
    "", "",
    // 52
    "Wartorn staff: (Weapon) [Spell] [Enemy] [15 FT] Deal 1D4 + 1D6 + 3 Magic damage [2 TP]",
    // 53
    "Warhammer: (Weapon) [Attack] [Enemy] [10 FT] Deal 2D4 + 2D6 + END damage, you may Boost this action for 3 Mana to knock the target prone and inflict Stun 1 [3 TP]",
    // 54
    "",
    // 55
    "Holy staff: (Weapon) [Spell] [Ally] [Self] [15 FT] Target gains a 6 + ALL shield until the start of their next turn [2 TP]",
    // 56
    "",
    // 57
    "Spirit blade: (Weapon) [Spell] [Enemy] [10 FT] Deal 1D8 + AGI damage, you may Boost this action for 6 Mana to make the target make a WIT save against you, on fail they take an additional 1D8 + AGI damage [2 TP]",
    // 58
    "",
    // 59
    "Great crossbow: (Weapon) [Attack] [Enemy] [25 FT] Deal 1D10 + AGI [2 TP]",
    // 60-69
    "Ritual shield: (Weapon) [Attack] [Enemy] [10 FT] Deal 1D12 + WIT Magic damage or gain a shield that lasts until the end of your next turn equal to the amount rolled [2 TP]",
    "Hunters bow: (Weapon) [Attack] [Enemy] [20 FT] Deal 1D4 + 8 damage [2 TP]",
    "",
    "",
    "",
    "",
    "Scimitar of the dark knighthood: (Weapon) [Attack] [Enemy] [10 FT] Deal 1D10 + INS as damage, you may Boost this action for 4 Mana to inflict Blind 3 [2 TP]",
    "",
    "",
    "Bone shatterer: (Weapon) [Attack] [Enemy] [10 FT]: Deal 2D6 + (3 * PWR) damage [3 TP]"
];
        
const spellList = [
    // 10
    "Volcanic eruption: [Fire] [Spell] [Enemy] [20 FT] Deal 2D8 +INS Fire damage and Burn to all enemies within a 10 ft area [3 TP, 12 Mana]   Spark: [Spell] [Enemy] [15 FT] Deal 1D4 + INS Fire damage, you may spend 2 Mana to deal +2 damage [1 TP, 6 Mana]",
    // 11
    "Aquatic surge: [Water] [Spell] [15 FT] Target a 10 FT area, all allies inside gain +7 Magic damage on their next attack. All enemies inside take 1D8 + WIT Magic damage [3 TP, 12 Mana]   Tidebreaker: [Water] [Spell] [Ally] [15 FT] Target gets healed by 4 + WIT and gets moved 10 FT [2 TP, 8 Mana]",
    // 12
    "",
    // 13
    "Tsunami: [Water] [Spell] Target a 15 foot wide and 25 foot long area in a direction, all units inside the range need to make an END save against you, on fail they are knocked outside the area and take 1D6 + WIT Magic damage, any ally hit with this gains a shield equal to your END until the end of their next turn [3 TP, 10 Mana]   Abyssal claw: [Spell] Deal 1D4 + END Magic damage and the target makes an END save against you, on fail they are pulled 10 FT towards you [2 TP, 8 Mana]",
    // 14
    "Flintlock pouch: [Fire] [Enemy] [10 FT] Inflict Burn [1 TP] OR [6 Mana] {once per turn}",
    // 15
    "Demonic extinguish: [Spell] [Enemy] [20 FT] Deal 1D4 + WIT Magic damage, if the target has Burn, deal an extra 1D12 Magic damage and remove the Burn [2 TP, 8 Mana]",
    // 16
    "Angel palm: [Light] [Spell] [Enemy] [15 FT] Deal 1D4 + END Magic damage and inflict Blind 2, if the target has Blind, they are also knocked prone and take 1D6 + END Magic damage [2 TP, 6 Mana]   Sunbeam: [Light] [Spell] [Enemy] [20 FT] Inflict Blind 1, then deal 3 + WIT Magic damage for every stack of Blind the target has, you may boost this action for 4 mana to inflict Burn [2 TP, 6 Mana]",
    // 17
    "Draconic barrier: Gain a 6 + END shield until the start of your next turn, you may boost this action for 4 mana to make the next attack used against you deal 1 damage [2 TP, 6 Mana]   Dragon breath: [Fire] Target a 10 FT long and 15 FT wide area in a direction. All enemies inside must make an END save, on fail they are knocked prone and takes 1D4 + END + INS Fire damage [2 TP, 10 Mana]",
    // 18
    "Plague kiss: [Poison] [Spell] [Enemy] [25 FT] Deal 1D6 + ALL Poison damage and inflict Poison [2 TP, 10 Mana]",
    // 19
    "Stone wall: [Terrain] make a 5 foot long and 25 foot wide stone wall that lasts until the end of your next turn. Any unit on top of Stone wall that is knocked prone or knocked back falls off taking 7 - their END damage [2 TP, 12 Mana]   Boulder toss: [Attack] [Enemy] [20 FT] Deal 1D8 + END damage [2 TP, 6 Mana]",
    // 20
    "Arcane bolt: [Spell] [Enemy] [20 FT] Deal 1D20 + INS Magic damage [2 TP, 12 Mana] OR [3 TP, 6 Mana]",
    // 21
    "Ray of sunshine: [Light] All enemies in a 10 FT area around you make an INS save, inflict Blind 3 and deal 1D6 + INS Magic damage on fail, you can boost this action for 6 Mana to give an additional Blind 2 [2 TP, 12 Mana]   Holy ray: [Spell] [Ally] [15 FT] Target is healed by 4 + ALL and gains a 4 + INS shield until the end of their next turn [2 TP, 8 Mana]   Empower: [Spell] [Ally] [15 FT] Target gains +1 to Hit and +2 + WIT damage on their next [Attack] action [1 TP, 6 Mana]",
    // 22
    "Petrifying gaze: [Spell] [Enemy] [20 FT] Deal 1D4 + ALL Magic damage and inflict a debuff that deals 1D4 + ALL Magic damage whenever they take damage until the end of their next turn. You may Boost this action for 8 Mana to make the target unable to move on their turn [2 TP, 10 Mana]   Energy syphon: [Spell] [Enemy] [15 FT] Deal 1D6 + ALL Magic damage, you heal for the damage dealt. You may boost this spell for 8 Mana to deal the same damage to all enemies within a 10 FT range around the target [2 TP, 8 Mana]",
    // 23
    "",
    // 24
    "Thunderbolt: [Spell] [Enemy] [15 FT] Deal 1D10 + INS Magic damage, if there's another enemy 10 FT of the target, they take 1D10 Magic damage [2 TP, 12 Mana]   Twin bolt: [Spell] [Enemy] [15 FT] Deal 1D6 + INS Magic damage to two unique targets, if there is an enemy within a 10 FT range of either target, they take 1D4 Magic damage [2 TP, 14 Mana]   Fierce gust: [Spell] [Enemy] [20 FT] Target gets moved 10 FT and makes an END save, on fail they are knocked prone, you may Boost this for 5 Mana to move them an extra 5 FT and deal 1D6 + INS Magic damage [2 TP, 12 Mana]",
    // 25
    "Bloodlust: [Ally] [Self] [15 FT] Target gains a buff that heals them for the damage they deal on their next (Weapon) action [2 TP, 10 Mana]   Taunt: [Attack] [Enemy] [15 FT] Deal 1D4 + END damage and force the target to make a (Weapon) action against you as soon as they are able to. When the target uses the (Weapon) action, they make an END save, on fail their action misses and deals 1D6 damage instead [2 TP, 8 Mana]",
    // 26
    "Underworld curse: [Fire] [Spell] [Enemy] [25 FT] Target takes 1D4 + WIT Fire damage for every 10 FT they move until the end of their turn. You may boost this action for 8 Mana to make it deal damage every 5 FT [2 TP, 10 Mana]   Infernal shove: [Fire] [Enemy] [15 FT] Move target 10 FT in any direction, after the target moves deal 1D6 + INS Fire damage to all enemies in a 5 FT range around the target [2 TP, 10 Mana]",
    // 27
    "Crimson blade: [Attack] [Enemy] [15 FT] Reduce your health to half your maximum health to deal 1D8 + (total lost health) [2 TP, 6 Mana]   Violent strike: [Attack] [Enemy] [10 FT] Deal 1D4 + (2 * PWR) damage [1 TP, 4 Mana]",
    // 28
    "Hell shard: [Attack] [Enemy] [20 FT] Deal 1D6 + AGI [1 TP, 6 Mana]",
    // 29
    "Aquatic chains: [Water] [Enemy] [20 FT] Target makes an AGI save against you, on fail they cannot move on their turn and take 1D6 + WIT Magic damage, you may boost this for 6 Mana to make the target fail and take an additional 1D4 Magic damage [2 TP, 12 Mana]",
    // 30
    "Nauseous gale: [Poison] [Spell] Force all units in a 15 FT range to make an INS save, any that fail take 1D8 + INS Poison damage [3 TP, 8 Mana]   Mystic fang: [Spell] [Enemy] [30 FT] Target takes 1D8 + INS Poison damage [2 TP, 6 Mana]",
    // 31
    "Curse of the wartorn: [Enemy] [20 FT] If the target attacks or casts an ability on their turn, they take 6 + 1D8 + INS mod dark damage [2 TP, 12 Mana]   Spirit shred: [Enemy] [20 FT] Targets Spirits is reduced by 5 until the end of their next turn [2 TP, 12 Mana]   Aura of insanity: Force all units within a 15 FT range to make an INS save, any that fail take 1D6 + INS dark damage and have Blind 3 [2 TP, 16 Mana]",
    // 32
    "Blessing of the mountain: [Self] [Ally] [20 FT] Target gains an additional 8 + 1D6 damage on their next (Weapon) action (once per target) [2 TP, 14 Mana] OR [3 TP, 4 Mana]   Stone pillar: [Terrain] [15 FT] Target a 5 FT area in range, a stone pillar that lasts until the start of your next turn is created on it. Any unit on the pillar is on high ground, you may boost this spell for 10 Mana to make the pillar 10 x 10 FT [2 TP]",
    // 33
    "Hail amulet: [Spell] [Enemy] [15 FT] {once per turn} Deal 1D6 Magic damage and target makes a WIT save, on fail they take 1D6 Magic damage and cannot move on their turn [1 TP]",
    // 34
    "Sun in a bottle: [Light] {once per turn} Apply Stun 2 and Blind 1 to all enemies in a 10 FT range [16 Mana] OR [1 TP, 10 Mana]   Blessing of the sun: [Self] [Ally] [20 FT] Target is healed by 1D6 + ALL and is given a buff that lasts until the start of their next turn. Any unit that targets them gains Blind 2 and takes 2 + ALL Magic damage [2 TP, 10 Mana]",
    // 35
    "Wrath of the holy: [Attack] [Enemy] [15 FT] Deal 4 + INS Magic damage, inflict Stun 2, and gain a shield for the damage dealt [2 TP] OR [1 TP, 10 Mana]   Swordplay: [Attack] [Enemy] [15 FT] Move 5 FT towards the target, deal 1D6 + (2 * PWR) damage, and the target makes a PWR save, on fail knock them prone and deal 4 damage, you may Boost this action for 6 Mana to instantly pass [2 TP, 12 Mana]",
    // 36
    "Infernal scream: [Fire] Force all units within a 10 FT range to make an END save, any unit that fails is knocked 10 FT back and takes 1D6 + WIT Fire damage [2 TP, 13 Mana]   Hellish charge: Target a 5 FT wide and 15 FT long area in any direction. All units in that area must make an END save, knock any that save prone and deal 1D10 + END damage, you may boost this action for 8 mana to inflict Cripple and instantly pass [2 TP, 12 Mana]",
    // 37
    "Sinister orb: [Spell] [Enemy] [25 FT] Deal 1D6 + END Magic damage, if the target is debuffed, they take an additional 1D8 Dark damage [2 TP, 4 Mana] OR [1 TP, 10 Mana]",
    // 38
    "Poison tip: [Ally] [Self] [15 FT] Target gets a buff where their next (Weapon) action inflicts Poison and deals an additional 2 * (TP cost) [1 TP, 10 Mana]   Beartrap: [10 FT] Place a trap in an empty space in range, the next enemy unit to step on it removes the trap and takes 2D8 + (2 * PWR) damage [2 TP, 6 Mana]",
    // 39
    "Honed strike: [Self] Gain +2 to hit and deal +5 damage on your next (Weapon) action [1 TP, 6 Mana]",
    // 40
    "Electro grid: Target a 10 x 10 FT area in a 20 FT range. All units inside the area must make an ALL save against you, any that fail are knocked prone and take 1D8 + ALL Magic damage [2 TP, 13 Mana]   Forked lightning: [Spell] [Enemy] [15 FT] Deal 1D8 + INS Magic damage and the target makes an END save, on fail they are knocked prone. You may boost this action for 4 Mana to extend the range to 25 FT and knock prone [2 TP, 14 Mana]",
    // 41
    "Harsh judgement: [Enemy] [20 FT] Target makes a WIT save, on fail they are knocked prone, cannot move on their turn, and have a debuff that deals (WIT) damage whenever they take damage until the end of their turn, you may boost this action for 8 Mana to pass the save and increase damage to 1D4 + WIT [2 TP, 16 Mana]   Eye of Aerid: [Spell] [Enemy] [20 FT] Deal 1D4 + WIT and inflict Blind 3, you may Boost this action for 8 Mana to also inflict Terrify [2 TP, 14 Mana]   Claw of Aerid: [Spell] [Enemy] [20 FT] Deal 1D4 + WIT and set the targets PWR to +0 until the end of your next turn [2 TP, 14 Mana]",
    // 42
    "Fierce tackle: [Attack] [Enemy] [20 FT] Deal 1D6 + PWR damage and move to the targets position, they make a PWR save against you, if they fail they are knocked prone and take 1D4 damage, you may Boost this action for 7 Mana to make your next (Weapon) action critically strike [2 TP, 10 Mana]",
    // 43
    "Mystic strike: Use an extra (Weapon) action this turn [1 TP, 10 Mana]",
    // 44
    "Brute shove: [Enemy] [15 FT] Force the target to make a PWR save, on fail they are knocked prone and take 1D8 + (2 * PWR) damage, you may Boost this action for 4 Mana to inflict Paralyze [2 TP, 12 Mana]   Titans barrier: Heal 1D4 + END health and gain a 2D6 shield until the start of your next turn [2 TP, 12 Mana]   Headbutt: [Attack] [Enemy] [10 FT] Deal 1D8 + (2 * PWR) damage, and the target makes an END save, on fail they are knocked prone and take 1D8 damage [2 TP, 10 Mana]",
    // 45
    "Lightning bomb: [Spell] [Enemy] [20 FT] Deal 1D6 + INS Magic damage and debuff the target. At the end of your turn they take 1D12 + INS Magic damage if the target is within 15 FT of another enemy, they take 1D6 + INS Magic damage [2 TP, 12 Mana]   Mystic push: [Spell] [Enemy] [20 FT] Deal 1D8 + INS Magic damage and the target makes a WIT save, on fail they are moved 10 FT in any direction [2 TP, 8 Mana]",
    // 46
    "Plague cloud: Create a 15 FT area around you that lasts until the start of your next turn, all enemies inside make an INS save, any that fail take 1D12 + INS Poison damage. Additionally, all enemy units inside have Blind 2 until they leave [2 TP, 15 Mana]   Venom wave: All units in a 10 FT area around you must make two INS saves, any that fail deal 1D6 + INS mod Poison damage [2 TP, 16 Mana]",
    // 47
    "",
    // 48
    "Warpath: Move 15 FT and your [Attack] actions have an extra +2 to Hit and deal an additional 3 + PWR damage until the end of the turn [1 TP, 10 Mana]   Horrific Foresight: [Enemy] [15 FT] Gain a +3 to Hit against the target until the end of this turn (does not stack) [1 TP, 6 Mana]",
    // 49
    "Rise from the dead: [25 FT] Target a 10 x 10 FT area in range, all enemies in that area make an END save, any that fail take 1D6 + WIT Magic damage and cannot use movement abilities until the end of their turn [2 TP, 16 Mana] OR [3 TP, 6 Mana]   Whispers of the damned: [Spell] [Enemy] [20 FT] Deal 1D6 + WIT Magic damage and inflict a debuff that lasts until the end of their next turn that makes them have a -2 to all saves [2 TP, 8 Mana]   Hand of the crypt: (Weapon) [Spell] [Enemy] [15 FT] Deal 1D6 + WIT Dark damage and force the target to make an END save, on fail they deal 3D4 less damage on their next [Attack] [2 TP] OR [1 TP, 10 Mana]",
    // 50
    "Grave dust: Target a 15 FT wide and 5 FT long area in front of you, all enemies inside make an END save, any that fail have Blind 1 and a debuff that makes them take (7 - their END) damage whenever they take Magic damage [2 TP, 10 Mana] OR [1 TP, 16 Mana]",
    // 51
    "Torpedo: [Ally] [20 FT] Give a buff that lasts until the end of the turn, whenever they use a [Spell] action, deal 3 + WIT Magic damage to the target [2 TP, 10 Mana]   Ring wave: [Ally] [20 FT] Heal the target by 1D4 + WIT health and knock back all enemies within a 10 FT range 10 FT back [2 TP, 18 Mana] OR [3 TP, 4 Mana]   Waveblade: [Ally] [Self] [20 FT] Give a buff that makes the next (Weapon) action crit and deal +5 Magic damage [2 TP, 14 Mana]",
    // 52
    "Warpath: [Enemy] [20 FT] Target is debuffed and takes 1D6 Dark damage whenever they are hit by a (Weapon) action until the end of their next turn [2 TP, 8 Mana]   Essence prison: [Enemy] [20 FT] Target is debuffed and takes 1D10 + INS Dark damage if they move (debuff ends as soon as the target takes damage) [1 TP, 10 Mana]",
    // 53
    "Tremor: [Attack] [Enemy] Target a 5 FT wide and 25 FT long area in any direction, and deal 1D6 + END damage to all enemies inside. Any unit that takes damage makes an END save, any that fail are knocked prone and have Stun 2 [3 TP, 8 Mana] OR [2 TP, 16 Mana]",
    // 54
    "Freezing tomb: [Spell] [Enemy] [25 FT] Deal 1D8 + INS Magic damage and the target makes an INS save, on fail they take 1D4 + 4 + INS Magic damage and can't move on their turn [2 TP, 14 Mana]   Icy wind: Target a 15 FT wide and 10 FT long area in any direction, all enemies inside are pushed to the edge of the area and make an END save, on fail they take 1D8 Magic damage [2 TP, 14 Mana]",
    // 55
    "Blessing of protection: [Ally] [Self] [20 FT] Target gains a 2D6 shield until the start of their next turn [2 TP, 12 Mana]   Ray of retribution: [Spell] [Enemy] [20 FT] Deal 1D6 + (your current shield) Magic damage [2 TP, 6 Mana]",
    // 56
    "Honour of alliance: [Ally] [15 FT] Remove a debuff and the closest enemy within a 10 FT range gets knocked prone and takes 1D6 damage, you may Boost this action for 6 Mana to give the ally a 6 health shield [1 TP, 8 Mana]   Bond of faith: [Ally] [15 FT] Target gains a buff and takes half damage from all sources and you receive the other half, lasts until the end of the targets next turn [2 TP, 12 Mana]   Royal charge: All allies within a 10 FT range gain +2 to Hit and +1 Swiftness until the end of your next turn [2 TP, 10 Mana]",
    // 57
    "Cloak and dagger: [Attack] [Enemy] [15 FT] Blink to an empty space within a 5 FT range of the target and deal 1D6 + AGI damage, the target then makes a WIT save, on fail they take an additional 1D8 + AGI damage [1 TP, 8 Mana]   Mind breaker: [Spell] [Enemy] [15 FT] Deal 1D6 + WIT damage and the target fails their next save [2 TP, 4 Mana] OR [1 TP, 14 Mana]",
    // 58
    "Steel arrow: [Attack] [Enemy] [20 FT] Deal 1D6 + (2 * PWR) damage [1 TP, 6 Mana]",
    // 59
    "Volley: [25 FT] Target a 10 x 10 ft area within range, all enemies inside must make an AGI save, any that fail take 1D6 + AGI damage [2 TP, 12 Mana]",
    // 60
    "Shield sweep: All enemies in a 10 FT range make an AGI save, anythat fail take 1D6 + WIT Magic damage and is knocked outside the area [2 TP, 10 Mana]   Power dash: Target a unit in a 15 FT range and move to an empty space in a 5 FT range around the target. If the target was an ally, give them a 1D8 + WIT shield until the end of their next turn. If the target was an enemy, deal 1D8 + WIT Magic damage [2 TP, 10 Mana] OR [1 TP, 16 Mana]",
    // 61
    "Justice leap: Move to an empty space in a 10 - 20 FT range. You may Boost this action for 4 Mana to have all enemies in a 5 FT range of your new location make a PWR save, any that fail are knocked prone and take 1D8 + (2 * PWR) damage [1 TP, 10 Mana]   Rampage: Gain +2 Swiftness, and +3 to Hit until the end of your next turn [2 TP, 8 Mana]",
    // 62
    "Combat roll: Move 10 FT in any direction, and you may make a (Weapon) action for 1 less TP cost at the end of the move [1 TP, 8 Mana]",
    // 63
    "Dark palm: [Attack] [Enemy] [5 FT] Deal 1D10 + WIT Dark damage and the target makes a WIT save, on fail they take 1D6 Dark damage [2 TP, 10 Mana]   Dark rush: [Attack] [Enemy] [15 FT] Deal 1D10 + WIT Dark damage and move up to 15 FT [2 TP, 10 Mana]   Facebreaker: [Enemy] [10 FT] Make 2 [Attack] rolls, any that hit deal 1D6 + WIT Magic damage [2 TP, 10 Mana]",
    // 64
    "Mana leak: [Allies] [25 FT] Target gains a buff that lasts until the end of their next turn where their spells have -3 Mana cost [2 TP, 14 Mana]   Evil spike: [Spell] [Enemy] [20 FT] Deal 1D4 + WIT Magic damage and inflict Break 1 [2 TP, 10 Mana]",
    // 65
    "Barrier: [Self] [Allies] [20 FT] Target gains a 5 Health shield until the end of their next turn [1 TP, 8 Mana]   Charge: [Attack] [Enemy] [15 FT] Move 15 FT in any direction, the first enemy hit takes 1D8 + END damage and makes an END save, on fail they are knocked 10 FT back and knocked prone [2 TP, 14 Mana]   Terrorize: All enemies in a 5 FT range must make an END save, on fail they must use a (Weapon) action against you on their turn with a -2 to Hit, you may Boost this action for 4 Maa to increase the range by 5 FT[2 TP, 14 Mana]",
    // 66
    "Cheapshot: [Attack] [Enemy] [10 FT] Deal 1D6 + INS damage and the target makes an INS save, on fail inflict Break 1 [2 TP, 8 Mana]",
    // 67
    "",
    // 68
    "Lightning beam: [Spell] [Enemy] [15 FT]: Target a 5 FT wide and 15 FT long area in any direction, all enemies inside take 1D6 + INS mod Thunder damage and must make an INS save against you, any that fail have Shock until the end of their next turn [2 TP, 14 Mana]   Zip: Target an empty space in a 20 FT range and move there, after you reach the destination, deal 1D4 + INS Thunder damage to all enemies in a 5 FT range, if they have Shock, they take 1D8 + INS Thunder damage instead and remove Shock, granting you 6 Mana [2 TP, 4 Mana]   Minibolt: [Spell] [Enemy] [20 FT] Deal 1D4 + INS Thunder damage, you may Boost this action for 2 Mana to inflict Shock [1 TP, 6 Mana]",
    // 69
    ""
];
        
const passiveList = [
    // 10
    "Hellish embers: Deal 3 extra Fire damage whenever you deal Fire damage",
    // 11
    "Sages charm: Whenever you buff an ally, they get a 4 Health shield until the end of their next turn",
    // 12
    "Rotting touch: Inflict Decay on critical strikes",
    // 13
    "",
    // 14
    "Cull of the charred: +3 Hit against Burning targets",
    // 15
    "Sinister lords ritual: The first non-movement action on your turn will inflict Burn and has -1 TP cost",
    // 16
    "",
    // 17
    "Dragonhide: You take 4 less damage from [Attacks]",
    // 18
    "Toxin charm: Whenever an enemy unit within a 25 foot range is Poisoned or inflicted with Decay, deal 4 damage to them",
    // 19
    "Heavy hitter: Stun 1 and deal a bonus 1D4 + (2 * PWR) on critical strikes",
    // 20
    "Arcane mastery: Gain +1 INS for every 10 max mana you have",
    // 21
    "",
    // 22
    "Cull of the meek: When targeting a Debuffed enemy, gain +1 to Hit, all allies attacking a debuffed target gain +1 to Hit",
    // 23
    "Brutality: When you kill a unit, move up to 10 FT and you may make another (Weapon) action for 1 less TP",
    // 24
    "",
    // 25
    "",
    // 26
    "",
    // 27
    "Reapers blessing: Landing an [Attack] heals you for 2 Health, Critically striking heals you for 5 Health",
    // 28
    "Imps agility: When you crit move 5 FT",
    // 29
    "",
    // 30
    "Blessing of the wise: Get a +2 to [Spell] rolls when targeting any unit with less WIT than you",
    // 31
    "",
    // 32
    "",
    // 33
    "Arcane ferocity: When you critically strike, deal 1D4 Magic damage and 1D6 Dark damage",
    // 34
    "",
    // 35
    "",
    // 36
    "Hellborne resistance: You take 1D8 less Magic damage from all sources in a 10 FT range",
    // 37
    "Sinister aura: All enemy units in a 15 FT range have a debuff that makes them have a -2 to all rolls when targeting you   Blinding essence: Your [Spell] actions inflict Blind 1",
    // 38
    "",
    // 39
    "Hunters ferocity: Your critical strikes deal an additional 6 damage",
    // 40
    "",
    // 41
    "",
    // 42
    "Gladiator: [Attack] rolls deal an additional 2 + 1D4 damage",
    // 43
    "",
    // 44
    "",
    // 45
    "Rune of wisdom: When making WIT rolls you get a +2, and when making INS rolls you get a +1",
    // 46
    "Necrotic: Deal an extra 1 + 1D4 Poison damage whenever you deal Poison damage",
    // 47
    "",
    // 48
    "Weapon mastery: Your (Weapon) actions have a +1 to Hit, while using your unarmed (Weapon) action you have a +3 to Hit",
    // 49
    "",
    // 50
    "Spirit armour: Whenever you are critically struck, take 2D4 less damage and deal the reduced damage to the enemy",
    // 51
    "",
    // 52
    "",
    // 53
    "Heavy handed: Knocking enemies prone deals 7 - (their END) damage",
    // 54
    "Northern wisdom: Gain a +2 to END saves and a +1 to INS saves",
    // 55
    "",
    // 56
    "",
    // 57
    "",
    // 58
    "Hasted: Whenever you hit an enemy, move 5 FT in any direction   Rogue tactics: After moving, your next action has a +2 to hit",
    // 59
    "Sharpshot: When attacking an enemy with 10 or less health, they make an AGI save, on fail they die",
    // 60
    "",
    // 61
    "Pummel: For every +1 to Hit you have, your (Weapon) deals an additional 2 damage",
    // 62
    "Straight shot: When using [Attacks] on an enemy outside of a 10 FT range, deal an additional 1D6 damage",
    // 63
    "",
    // 64
    "Heightened senses: All allies in a 10 FT range gain +2 to Hit to all [Spell] rolls",
    // 65
    "",
    // 66
    "Dark pact: When an enemy in a 20 FT range gets a debuff, they take 1D6 Dark damage",
    // 67
    "Wrath: Gain a buff that lasts until the end of your next turn where you get +2 to Hit and deal an additional (PWR) damage on all [Attack] actions   Heartseeker: Gain a +2 to Hit on all (Weapon) actions and critical strikes deal an additional 4 damage",
    // 68
    "",
    // 69
    "Bloodletter: Your next attack critically strikes and deals an additional 1D10 damage [2 TP, 8 Mana]   Battle lunge: Move up to 10 FT in any direction and deal an extra 3 damage on your next [Attack] action [1 TP, 4 Mana]"
];
        
const itemList = [
    // 10
    { name: "Demonic charm", statEffects: { INS: 3, WIT: 2 }, attributeEffects: { spirit: 1 } },
    // 11
    { name: "Aquamancers bracelet", statEffects: {}, attributeEffects: { mana: 6, health: 2, manaregen: 2 } },
    // 12
    { name: "Hunters armlet", statEffects: { AGI: 3, PWR: 2 }, attributeEffects: { swiftness: 1 } },
    // 13
    { name: "Seafolk tiara", statEffects: { END: 3, WIT: 2 }, attributeEffects: { spirit: 1 } },
    // 14
    { name: "Angelic chestplate", statEffects: { PWR: 3, END: 1 }, attributeEffects: { health: 4 } },
    // 15
    { name: "Underworld gemstone", statEffects: { WIT: 2 }, attributeEffects: { mana: 4, spirit: 2 } },
    // 16
    { name: "Cloudstriders charm", statEffects: { END: 3, WIT: 2 }, attributeEffects: { health: 2 } },
    // 17
    { name: "Dragonscale chestplate", statEffects: { END: 2, INS: 2 }, attributeEffects: { health: 6 } },
    // 18
    { name: "Draconic cloak", statEffects: { AGI: 2, ALL: 2 }, attributeEffects: { manaregen: 1, swiftness: 1 } },
    // 19
    { name: "Geomancers chestplate", statEffects: { END: 2, PWR: 2 }, attributeEffects: { manaregen: 2 } },
    // 20
    { name: "Archmage's amulet", statEffects: { INS: 3, WIT: 2 }, attributeEffects: { mana: 2 } },
    // 21
    { name: "Holy locket", statEffects: { INS: 2, ALL: 2, WIT: 1 }, attributeEffects: { manaregen: 1 } },
    // 22
    { name: "Shamans garb", statEffects: { ALL: 2 }, attributeEffects: { health: 4, mana: 4 } },
    // 23
    { name: "Rampagers helmet", statEffects: { PWR: 3, AGI: 3 }, attributeEffects: {} },
    // 24
    { name: "Electromancers helmet", statEffects: { INS: 2 }, attributeEffects: { manaregen: 3, spirit: 1 } },
    // 25
    { name: "Gladiators cape", statEffects: { END: 2 }, attributeEffects: { health: 6, swiftness: 1 } },
    // 26
    { name: "Infernal charm", statEffects: { INS: 3 }, attributeEffects: { mana: 2, manaregen: 2 } },
    // 27
    { name: "Warlords leg guards", statEffects: { PWR: 2, AGI: 2 }, attributeEffects: { health: 4 } },
    // 28
    { name: "Dark omen of protection", statEffects: { AGI: 3, ALL: 2 }, attributeEffects: { mana: 2 } },
    // 29
    { name: "Waveskipper boots", statEffects: { AGI: 3, WIT: 2, INS: 1 }, attributeEffects: {} },
    // 30
    { name: "Wizards robe", statEffects: { WIT: 2, INS: 2 }, attributeEffects: { mana: 4 } },
    // 31
    { name: "Shamans warpaint", statEffects: { INS: 2 }, attributeEffects: { mana: 6, manaregen: 1 } },
    // 32
    { name: "Dwarven war helm", statEffects: { END: 3, PWR: 2, AGI: 1 }, attributeEffects: {} },
    // 33
    { name: "Priests necklace", statEffects: { WIT: 3, INS: 2 }, attributeEffects: { health: 2 } },
    // 34
    { name: "Dancers armlet", statEffects: { ALL: 3, WIT: 1 }, attributeEffects: { manaregen: 2 } },
    // 35
    { name: "Knights armour", statEffects: { PWR: 2, INS: 2 }, attributeEffects: { health: 4 } },
    // 36
    { name: "Old gods garb", statEffects: { END: 2, WIT: 2 }, attributeEffects: { health: 2, manaregen: 1 } },
    // 37
    { name: "Dark iron armour", statEffects: { END: 2, WIT: 2 }, attributeEffects: { mana: 4 } },
    // 38
    { name: "Wild armlet", statEffects: { AGI: 3, PWR: 2, ALL: 1 }, attributeEffects: { manaregen: 1 } },
    // 39
    { name: "Berzerkers chestplate", statEffects: { PWR: 3, AGI: 1 }, attributeEffects: { health: 4 } },
    // 40
    { name: "Raindancers headband", statEffects: { INS: 2, WIT: 2, ALL: 2 }, attributeEffects: {} },
    // 41
    { name: "Dark priests crystal eye", statEffects: { WIT: 3 }, attributeEffects: { manaregen: 3 } },
    // 42
    { name: "Gladiators warpaint", statEffects: { PWR: 2, AGI: 1 }, attributeEffects: { health: 2, manaregen: 1 } },
    // 43
    { name: "Band of Nasmanai", statEffects: { AGI: 3, INS: 2 }, attributeEffects: { swiftness: 1 } },
    // 44
    { name: "Titan bracelet", statEffects: { END: 3, PWR: 3 }, attributeEffects: {} },
    // 45
    { name: "Sacrificers gauntlet", statEffects: { INS: 3, WIT: 1 }, attributeEffects: { spirit: 2 } },
    // 46
    { name: "Venomancers hood", statEffects: { INS: 2, WIT: 2 }, attributeEffects: { manaregen: 1 } },
    // 47
    { name: "Elementalists ring", statEffects: { PWR: 2, AGI: 2, ALL: 2 }, attributeEffects: {} },
    // 48
    { name: "Spiked handwraps", statEffects: { PWR: 3, AGI: 1 }, attributeEffects: { swiftness: 2} },
    // 49
    { name: "Tomb shard", statEffects: { END: 2, WIT: 2, ALL: 2 }, attributeEffects: {} },
    // 50
    { name: "Gravediggers pendant", statEffects: { END: 3, WIT: 2 }, attributeEffects: { spirit: 1 } },
    // 51
    { name: "Wise amulet", statEffects: { WIT: 2 }, attributeEffects: { mana: 6, manaregen: 1 } },
    // 52
    { name: "Forbidden crown", statEffects: { INS: 3, WIT: 1 }, attributeEffects: { spirit: 1 } },
    // 53
    { name: "Buried gauntlet", statEffects: { END: 4 }, attributeEffects: { health: 4, spirit: 1 } },
    // 54
    { name: "Frostborn bracelet", statEffects: { END: 2, INS: 2 }, attributeEffects: { swiftness: 1, spirit: 1 } },
    // 55
    { name: "Priests robe", statEffects: { ALL: 2, WIT: 1 }, attributeEffects: { mana: 6 } },
    // 56
    { name: "Kings cloak", statEffects: {}, attributeEffects: { health: 6, mana: 4, swiftness: 1 } },
    // 57
    { name: "Veil of shadows", statEffects: { AGI: 2, WIT: 2 }, attributeEffects: { spirit: 1, manaregen: 1 } },
    // 58
    { name: "Skinning knife", statEffects: { AGI: 2, PWR: 2, ALL: 1 }, attributeEffects: { mana: 2, manaregen: 1 } },
    // 59
    { name: "Great rogues regalia", statEffects: { AGI: 3, ALL: 3 }, attributeEffects: {} },
    // 60
    { name: "Armlet of the sacrificed", statEffects: { AGI: 2, WIT: 2 }, attributeEffects: { health: 4 } },
    // 61
    { name: "Dark iron gauntlets", statEffects: { PWR: 3, AGI: 1 }, attributeEffects: { manaregen: 2 } },
    // 62
    { name: "Druid's satchel", statEffects: { AGI: 2 }, attributeEffects: { mana: 6, manaregen: 1 } },
    // 63
    { name: "Dark lords headband", statEffects: { AGI: 2, WIT: 2 }, attributeEffects: { mana: 2, manaregen: 1 } },
    // 64
    { name: "Cryptborn necklace", statEffects: { WIT: 2 }, attributeEffects: { mana: 8 } },
    // 65
    { name: "Minotaur horn", statEffects: { END: 2 }, attributeEffects: { health: 6, manaregen: 1 } },
    // 66
    { name: "Helmet of the dark knighthood", statEffects: { INS: 2 }, attributeEffects: { mana: 4, manaregen: 2 } },
    // 67
    { name: "Gladiators handwraps", statEffects: { PWR: 3, AGI: 2 }, attributeEffects: { swiftness: 1 } },
    // 68
    { name: "Bracelet of the lightning monk", statEffects: { INS: 2, WIT: 2 }, attributeEffects: { mana: 2, manaregen: 1 } },
    // 69
    { name: "Great berzerkers crown", statEffects: { PWR: 3, AGI: 2 }, attributeEffects: { manaregen: 1 } }
];

const profList = [
    // 10
    "+1 Arcana +1 Foresight +1 Taming",
    // 11
    "+2 Performance +1 Foresight",
    // 12
    "+2 Stealth +1 Athletics",
    // 13
    "+2 Taming +1 Arcana",
    // 14
    "+2 Might +1 Survival",
    // 15
    "+1 Might +1 Perception +1 Foresight",
    // 16
    "+2 Perception",
    // 17
    "+1 Survival +1 Resist",
    // 18
    "+1 Theft +1 Persuasion",
    // 19
    "+1 Survival +1 Resist +1 Athletics",
    // 20
    "+2 Arcana +1 Perception",
    // 21
    "+2 Arcana +1 Taming",
    // 22
    "+2 Performance +1 Arcana",
    // 23
    "+2 Might +1 Resist",
    // 24
    "+1 Resist +1 Survival +1 Performance",
    // 25
    "+2 Survival +1 Athletics",
    // 26
    "+1 Might +1 Theft +1 Persuasion",
    // 27
    "+2 Athletics +1 Stealth",
    // 28
    "+2 Stealth +1 Theft",
    // 29
    "+2 Taming +1 Athletics",
    // 30
    "+2 Foresight +1 Survival",
    // 31
    "+2 Performance +1 Survival",
    // 32
    "+2 Might",
    // 33
    "+1 Might +1 Arcana",
    // 34
    "+3 Performance",
    // 35
    "+2 Resist",
    // 36
    "+1 Survival +1 Arcana",
    // 37
    "+1 Might +1 Performance +1 Arcana",
    // 38
    "+2 Survival +1 Taming",
    // 39
    "+1 Athletics +1 Might +1 Survival",
    // 40
    "+1 Performance +1 Perception",
    // 41
    "+1 Perception +1 Arcana +1 Foresight",
    // 42
    "+1 Athletics +1 Survival +1 Foresight",
    // 43
    "+2 Theft +1 Stealth",
    // 44
    "+3 Might",
    // 45
    "+2 Arcana +1 Might",
    // 46
    "+2 Survival +1 Arcana",
    // 47
    "+2 Perception",
    // 48
    "+1 Survival +1 Perception",
    // 49
    "+2 Arcana +1 Performance",
    // 50
    "+1 Stealth +1 Survival",
    // 51
    "",
    // 52
    "+1 Stealth +1 Performance +1 Arcana",
    // 53
    "+2 Athletics +1 Survival",
    // 54
    "+2 Taming +1 Survival",
    // 55
    "+2 Perception +1 Arcana",
    // 56
    "+2 Perception",
    // 57
    "+2 Performance +1 Athletics",
    // 58
    "+1 Survival +1 Persuasion +1 Performance",
    // 59
    "+3 Stealth",
    // 60
    "+1 Might +1 Taming +1 Foresight",
    // 61
    "+1 Might +1 Taming",
    // 62
    "+2 Taming",
    // 63
    "+1 Might +1 Arcana",
    // 64
    "+2 Arcana +1 Performance",
    // 65
    "+2 Arcana +1 Foresight",
    // 66
    "+2 Perception",
    // 67
    "+1 Athletics",
    // 68
    "+1 Survival +1 Arcana",
    // 69
    "+2 Might +1 Survival"
];
        
        const loreList = [
            "You are a knight!",
            "You are a mage!",
            "You are a rogue!",
            "You are a cleric!",
            "You are a ranger!",
            // Add more lore as needed
        ];
        
        // Weird world additions (only available when toggle is on)
        const weirdWorldWeapons = [
            "Cosmic Blade", "Reality Warper", "Void Bow"
        ];
        
        const weirdWorldSpells = [
            "Black Hole", "Time Stop", "Dimension Door"
        ];
        
        const weirdWorldPassives = [
            "Quantum Entanglement", "Parallel Selves", "Probability Manipulation"
        ];
        
        const weirdWorldItems = [
            { name: "Singularity Core", statEffects: { ALL: 3 }, attributeEffects: { spirit: 5, advantage: 2 } },
            { name: "Dimensional Boots", statEffects: { AGI: 5 }, attributeEffects: { swiftness: 5 } }
        ];
        
        const weirdWorldLore = [
            "You are from another dimension!",
            "The laws of physics don't apply to you!",
            "You see through the veil of reality!"
        ];
        
        const weirdWorldProfList = [
            "+3 Quantum Physics +1 Reality Warping",
            "+2 Chronomancy +1 Dimensional Rifting",
            // Add more weird world professions
        ];
        
        // DOM elements
        const weaponBox = document.getElementById('weaponBox');
        const spellBox = document.getElementById('spellBox');
        const passiveBox = document.getElementById('passiveBox');
        const itemBox = document.getElementById('itemBox');
        const loreBox = document.getElementById('loreBox');
        const rerollButton = document.getElementById('rerollButton');
        const profBox = document.getElementById('profBox');
        const loreToggle = document.getElementById('loreToggle');
        const weirdWorldToggle = document.getElementById('weirdWorldToggle');
        
        // Stat display elements
        const endStat = document.getElementById('endStat');
        const insStat = document.getElementById('insStat');
        const witStat = document.getElementById('witStat');
        const agiStat = document.getElementById('agiStat');
        const allStat = document.getElementById('allStat');
        const pwrStat = document.getElementById('pwrStat');
        
        // Attribute display elements
        const healthStat = document.getElementById('healthStat');
        const manaStat = document.getElementById('manaStat');
        const manaregenStat = document.getElementById('manaregenStat');
        const swiftnessStat = document.getElementById('swiftnessStat');
        const spiritStat = document.getElementById('spiritStat');
        const advantageStat = document.getElementById('advantageStat');
        
        // Manager section elements
        const resourceInput = document.getElementById('resourceInput');
        const gainButton = document.getElementById('gainButton');
        const loseButton = document.getElementById('loseButton');
        const healthToggle = document.getElementById('healthToggle');
        const manaToggle = document.getElementById('manaToggle');
        const tpToggle = document.getElementById('tpToggle');
        
        // Function to get a random number within a range
        function getRandomNumber(max, min = 0) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        // Function to reset all stats and attributes to base values
        function resetStatsAndAttributes() {
            console.log("--- resetStatsAndAttributes Debug ---");
            console.log("Resetting all stats and attributes to base values");
            
            // Reset stats
            stats = {
                END: 0,
                INS: 0,
                WIT: 0,
                AGI: 0,
                ALL: 0,
                PWR: 0
            };
            
            // Reset attributes to base values
            attributes = JSON.parse(JSON.stringify(baseAttributes));
            
            // Reset current and max health/mana (they'll be recalculated during reroll)
            maxHealth = baseAttributes.health;
            currentHealth = maxHealth;
            maxMana = baseAttributes.mana;
            currentMana = maxMana;
        
            // Update stat displays
            updateStatDisplays();
            
            console.log("After reset:", {
                stats: JSON.parse(JSON.stringify(stats)),
                attributes: JSON.parse(JSON.stringify(attributes)),
                currentHealth,
                maxHealth,
                currentMana,
                maxMana
            });
        }
        
        // Function to update all stat displays
        function updateStatDisplays() {
            endStat.textContent = `END: ${stats.END > 0 ? '+' : ''}${stats.END}`;
            insStat.textContent = `INS: ${stats.INS > 0 ? '+' : ''}${stats.INS}`;
            witStat.textContent = `WIT: ${stats.WIT > 0 ? '+' : ''}${stats.WIT}`;
            allStat.textContent = `ALL: ${stats.ALL > 0 ? '+' : ''}${stats.ALL}`;
            agiStat.textContent = `AGI: ${stats.AGI > 0 ? '+' : ''}${stats.AGI}`;
            pwrStat.textContent = `PWR: ${stats.PWR > 0 ? '+' : ''}${stats.PWR}`;
            
            // Update attribute displays with current/max values
            healthStat.textContent = `Health: ${maxHealth} / ${currentHealth}`;
            manaStat.textContent = `Mana: ${maxMana} / ${currentMana}`;
            manaregenStat.textContent = `Mana Regen: ${attributes.manaregen}`;
            spiritStat.textContent = `Spirit: ${attributes.spirit}`;
            swiftnessStat.textContent = `Swiftness: ${attributes.swiftness}`;
            advantageStat.textContent = `Advantage: ${attributes.advantage}`;

            // Update resource displays when stats change
            updateResourceDisplays();
        }
        
        // Function to apply stat changes (handles opposites)
        function applyStatChanges(statChanges) {
            // First apply all the positive changes
            for (const [stat, value] of Object.entries(statChanges)) {
                stats[stat] += value;
            }
            
            // Then apply the opposite stat changes
            for (const [stat, value] of Object.entries(statChanges)) {
                switch(stat) {
                    case 'END':
                        stats.ALL -= value;
                        break;
                    case 'ALL':
                        stats.END -= value;
                        break;
                    case 'AGI':
                        stats.INS -= value;
                        break;
                    case 'INS':
                        stats.AGI -= value;
                        break;
                    case 'PWR':
                        stats.WIT -= value;
                        break;
                    case 'WIT':
                        stats.PWR -= value;
                        break;
                }
            }
            
            // Update attributes based on stats
            updateAttributesFromStats();
        }
        
        // Function to update attributes based on current stats and item bonuses
        function updateAttributesFromStats() {
            console.log("--- updateAttributesFromStats Debug ---");
            console.log("Current stats:", JSON.parse(JSON.stringify(stats)));
            console.log("Current attributes BEFORE reset:", JSON.parse(JSON.stringify(attributes)));
            
            // Reset to base values first
            attributes.health = baseAttributes.health;
            attributes.mana = baseAttributes.mana;
            attributes.manaregen = baseAttributes.manaregen;
            attributes.swiftness = baseAttributes.swiftness;
            attributes.spirit = baseAttributes.spirit;
            attributes.advantage = baseAttributes.advantage;
            
            console.log("After reset to base:", JSON.parse(JSON.stringify(attributes)));
            
            // Apply stat bonuses
            attributes.health += stats.END;
            attributes.mana += stats.INS;
            attributes.manaregen += stats.WIT;
            attributes.swiftness += stats.AGI;
            attributes.spirit += stats.ALL;
            attributes.advantage += stats.PWR;
            
            console.log("After applying stat bonuses:", JSON.parse(JSON.stringify(attributes)));
        }

        // Function to apply attribute changes (from items)
        function applyAttributeChanges(attributeChanges) {
            // First update base attributes from stats
            updateAttributesFromStats();
            
            // Apply item bonuses to both attributes and max values
            for (const [attribute, value] of Object.entries(attributeChanges)) {
                // Convert attribute name to lowercase to ensure consistency
                const normalizedAttr = attribute.toLowerCase();
                if (attributes.hasOwnProperty(normalizedAttr)) {
                    attributes[normalizedAttr] += value;
                } else {
                    console.warn(`Unknown attribute: ${attribute}`);
                }
            }
            
            // Calculate final max values after all bonuses are applied
             maxHealth = attributes.health;
             maxMana = attributes.mana;
            
            // Set current values (without exceeding max)
            currentHealth = Math.min(currentHealth, maxHealth);
            currentMana = Math.min(currentMana, maxMana);
        }

        function AdjustHealthMana() {
            console.log("--- AdjustHealthMana called! ---");
            currentHealth = maxHealth;
            currentMana = maxMana;
        }
        
        // Function to perform a reroll
        function reroll() {
            // Clear all boxes
            weaponBox.textContent = '';
            spellBox.textContent = '';
            passiveBox.textContent = '';
            itemBox.textContent = '';
            loreBox.textContent = '';
            profBox.textContent = '';
            
            // Reset stats and attributes
            resetStatsAndAttributes();
            
            // Determine the maximum index based on toggle
            const maxRegularIndex = 58; // Regular items (0-58) → 59 items
            const maxWeirdWorldIndex = 69; // Weird World items (59-69) → 11 items
            
            const maxIndex = weirdWorldToggle.checked ? maxWeirdWorldIndex : maxRegularIndex;
            
            // Get two different random numbers
            let num1 = getRandomNumber(maxIndex);
            let num2 = getRandomNumber(maxIndex);
            
            // Ensure they're different
            while (num2 === num1) {
                num2 = getRandomNumber(maxIndex);
            }

            // Store the roll numbers
            currentRollNumbers = [num1, num2];

            console.log("Rolled numbers:", num1, num2);
            
            // Get items from lists - changed these to let since we might reassign them for weird world
            let weapon1 = num1 < weaponList.length ? weaponList[num1] : "N/A";
            let weapon2 = num2 < weaponList.length ? weaponList[num2] : "N/A";
            
            let spell1 = num1 < spellList.length ? spellList[num1] : "N/A";
            let spell2 = num2 < spellList.length ? spellList[num2] : "N/A";
            
            let passive1 = num1 < passiveList.length ? passiveList[num1] : "N/A";
            let passive2 = num2 < passiveList.length ? passiveList[num2] : "N/A";
            
            let item1 = num1 < itemList.length ? itemList[num1] : { name: "N/A" };
            let item2 = num2 < itemList.length ? itemList[num2] : { name: "N/A" };
            
            let lore1 = num1 < loreList.length ? loreList[num1] : "N/A";
            let lore2 = num2 < loreList.length ? loreList[num2] : "N/A";
            
            // Get professions from lists - changed to let for weird world reassignment
            let prof1 = num1 < profList.length ? profList[num1] : "+0 Bonus";
            let prof2 = num2 < profList.length ? profList[num2] : "+0 Bonus";
            AdjustHealthMana();
            // Get weird world professions if toggle is on
            if (weirdWorldToggle.checked) {
                if (num1 >= maxRegularIndex) {
                    const weirdIndex = num1 - maxRegularIndex;
                    if (weirdIndex < weirdWorldProfList.length) {
                        prof1 = weirdWorldProfList[weirdIndex];
                    }
                }
                if (num2 >= maxRegularIndex) {
                    const weirdIndex = num2 - maxRegularIndex;
                    if (weirdIndex < weirdWorldProfList.length) {
                        prof2 = weirdWorldProfList[weirdIndex];
                    }
                }
            }

            // Process and combine professions
            const combinedProfessions = combineProfessions(prof1, prof2);
            profBox.textContent = combinedProfessions;
            
            // Get weird world items if toggle is on and numbers are in that range
            if (weirdWorldToggle.checked) {
                if (num1 >= maxRegularIndex) {
                    const weirdIndex = num1 - maxRegularIndex;
                    if (weirdIndex < weirdWorldWeapons.length) weapon1 = weirdWorldWeapons[weirdIndex];
                    if (weirdIndex < weirdWorldSpells.length) spell1 = weirdWorldSpells[weirdIndex];
                    if (weirdIndex < weirdWorldPassives.length) passive1 = weirdWorldPassives[weirdIndex];
                    if (weirdIndex < weirdWorldItems.length) item1 = weirdWorldItems[weirdIndex];
                    if (weirdIndex < weirdWorldLore.length) lore1 = weirdWorldLore[weirdIndex];
                }
                
                if (num2 >= maxRegularIndex) {
                    const weirdIndex = num2 - maxRegularIndex;
                    if (weirdIndex < weirdWorldWeapons.length) weapon2 = weirdWorldWeapons[weirdIndex];
                    if (weirdIndex < weirdWorldSpells.length) spell2 = weirdWorldSpells[weirdIndex];
                    if (weirdIndex < weirdWorldPassives.length) passive2 = weirdWorldPassives[weirdIndex];
                    if (weirdIndex < weirdWorldItems.length) item2 = weirdWorldItems[weirdIndex];
                    if (weirdIndex < weirdWorldLore.length) lore2 = weirdWorldLore[weirdIndex];
                }
            }
            
            // Display results with proper line breaks
            weaponBox.innerHTML = formatMultiItemEntry(`${weapon1}<br><br>${weapon2}`);
            spellBox.innerHTML = formatMultiItemEntry(`${spell1}<br><br>${spell2}`);
            passiveBox.innerHTML = formatMultiItemEntry(`${passive1}<br><br>${passive2}`);
            itemBox.innerHTML = formatMultiItemEntry(`${formatItemText(item1)}<br><br>${formatItemText(item2)}`);
            
            // Display lore if toggle is on
            if (loreToggle.checked) {
                loreBox.innerHTML = `${lore1}<br><br>${lore2}`;
            }
            
            // Debug: Log item attribute effects
            console.log("--- Debugging Attribute Effects ---");
            console.log("Item 1:", item1.name);
            if (item1.attributeEffects) {
                console.log("Item 1 attributeEffects:", item1.attributeEffects);
            } else {
                console.log("Item 1 has no attributeEffects!");
            }
            
            console.log("Item 2:", item2.name);
            if (item2.attributeEffects) {
                console.log("Item 2 attributeEffects:", item2.attributeEffects);
            } else {
                console.log("Item 2 has no attributeEffects!");
            }
            
            // NEW STAT LOGIC: Apply stat changes first
            if (item1.statEffects) applyStatChanges(item1.statEffects);
            if (item2.statEffects) applyStatChanges(item2.statEffects);
            
            // Then apply attribute changes (including any direct health bonuses)
            if (item1.attributeEffects) {
                console.log("Applying Item 1 attributeEffects:", item1.attributeEffects);
                applyAttributeChanges(item1.attributeEffects);
            }
            if (item2.attributeEffects) {
                console.log("Applying Item 2 attributeEffects:", item2.attributeEffects);
                applyAttributeChanges(item2.attributeEffects);
            }
    
            // Debug: Log final attribute values
            console.log("Final attributes after changes:", {
                health: maxHealth,
                mana: maxMana,
                manaregen: attributes.manaregen,
                swiftness: attributes.swiftness,
                spirit: attributes.spirit,  // Fixed typo here (was previously 'spirit')
                advantage: attributes.advantage,
                stats: JSON.parse(JSON.stringify(stats)),
                baseAttributes: JSON.parse(JSON.stringify(baseAttributes))
            });
            AdjustHealthMana();
            updateImages(num1, num2);
            // Update displays
            updateStatDisplays();

            // Create action buttons and update displays
            createActionButtons();
            createUniversalButtons();
            updateResourceDisplays();
            
            // Reset turn state
            currentTP = 6;
            weaponUsed = false;
        }

        // Helper function to format item text with stats
        function formatItemText(item) {
            let text = item.name;
            const statParts = [];
            const attributeParts = [];
            
            // Add stat effects if they exist
            if (item.statEffects) {
                for (const [stat, value] of Object.entries(item.statEffects)) {
                    statParts.push(`${value > 0 ? '+' : ''}${value} ${stat}`);
                }
            }
            
            // Add attribute effects if they exist
            if (item.attributeEffects) {
                for (const [attr, value] of Object.entries(item.attributeEffects)) {
                    // Capitalize first letter for display only
                    const displayName = attr.charAt(0).toUpperCase() + attr.slice(1).toLowerCase();
                    attributeParts.push(`${value > 0 ? '+' : ''}${value} ${displayName}`);
                }
            }
            
            // Combine all parts
            const allParts = [...statParts, ...attributeParts];
            if (allParts.length > 0) {
                text += ` (${allParts.join(', ')})`;
            }
            
            return text;
        }

        // Helper function to split and format multi-item entries
        function formatMultiItemEntry(entry) {
            // Split by 3 or more spaces (regex: \s{3,})
            return entry.split(/\s{3,}/).join('<br><br>');
        }

        // New function to combine and format professions
        function combineProfessions(prof1, prof2) {
            const skillMap = new Map();
            
            // Helper function to parse and add skills
            function parseSkills(profText) {
                const skillMatches = profText.matchAll(/\+(\d+) (\w+)/g);
                for (const match of skillMatches) {
                    const value = parseInt(match[1]);
                    const skill = match[2];
                    skillMap.set(skill, (skillMap.get(skill) || 0) + value);
                }
            }
            
            // Parse both profession strings
            parseSkills(prof1);
            parseSkills(prof2);
            
            // Convert to array and sort
            const sortedSkills = Array.from(skillMap.entries())
                .sort((a, b) => {
                    // First sort by value (descending)
                    if (b[1] !== a[1]) return b[1] - a[1];
                    // Then sort alphabetically
                    return a[0].localeCompare(b[0]);
                });
            
            // Format the output
            return sortedSkills.map(([skill, value]) => `+${value} ${skill}`).join(', ');
        }
        
        // Function to handle resource changes
        function changeResource(amount) {
            const value = parseInt(resourceInput.value) || 0;
            const changeAmount = amount * value;
            
            if (healthToggle.checked) {
                // Change health
                currentHealth += changeAmount;
                currentHealth = Math.max(0, Math.min(currentHealth, maxHealth));
            } else if (manaToggle.checked) {
                // Change mana
                currentMana += changeAmount;
                currentMana = Math.max(0, Math.min(currentMana, maxMana));
            } else if (tpToggle.checked) {
                // Change TP
                currentTP += changeAmount;
                currentTP = Math.max(0, Math.min(currentTP, 6));
            }
            
            updateStatDisplays();
            updateResourceDisplays();
            updateButtonStates();
            resourceInput.value = '';
        }

                // Add function to create universal action buttons
        function createUniversalButtons() {
            const container = document.getElementById('universalButtons');
            container.innerHTML = '';
            
            // Walk button
            const walkBtn = document.createElement('button');
            walkBtn.className = 'action-button';
            walkBtn.textContent = 'Walk';
            walkBtn.title = 'Move 10 FT';
            walkBtn.dataset.tpCost = '1';
            walkBtn.addEventListener('click', () => {
                useAction(1, 0, false);
                updateResourceDisplays();
                updateButtonStates();
            });
            container.appendChild(walkBtn);
            
            // Run button
            const runBtn = document.createElement('button');
            runBtn.className = 'action-button';
            runBtn.textContent = 'Run';
            runBtn.title = 'Move 20 FT';
            runBtn.dataset.tpCost = '2';
            runBtn.addEventListener('click', () => {
                useAction(2, 0, false);
                updateResourceDisplays();
                updateButtonStates();
            });
            container.appendChild(runBtn);
            
            // Sprint button
            const sprintBtn = document.createElement('button');
            sprintBtn.className = 'action-button';
            sprintBtn.textContent = 'Sprint';
            sprintBtn.title = 'Move 30 FT';
            sprintBtn.dataset.tpCost = '3';
            sprintBtn.addEventListener('click', () => {
                useAction(3, 0, false);
                updateResourceDisplays();
                updateButtonStates();
            });
            container.appendChild(sprintBtn);
            
            // Unarmed attack button
            const unarmedBtn = document.createElement('button');
            unarmedBtn.className = 'action-button weapon';
            unarmedBtn.textContent = 'Unarmed Attack';
            unarmedBtn.title = 'Deal 1D6 + PWR damage';
            unarmedBtn.dataset.tpCost = '1';
            unarmedBtn.dataset.isWeapon = 'true';
            unarmedBtn.addEventListener('click', () => {
                useAction(1, 0, true);
                updateResourceDisplays();
                updateButtonStates();
            });
            container.appendChild(unarmedBtn);
            
            // Regenerate button
            const regenBtn = document.createElement('button');
            regenBtn.className = 'action-button';
            regenBtn.textContent = 'Regenerate';
            regenBtn.title = 'Heal 3 Health and Mana';
            regenBtn.dataset.tpCost = '1';
            regenBtn.addEventListener('click', () => {
                useAction(1, 0, false);
                currentHealth = Math.min(maxHealth, currentHealth + 3);
                currentMana = Math.min(maxMana, currentMana + 3);
                updateResourceDisplays();
                updateButtonStates();
                updateStatDisplays();
            });
            container.appendChild(regenBtn);
        }
        
        // Event listeners for manager section
        gainButton.addEventListener('click', () => changeResource(1));
        loseButton.addEventListener('click', () => changeResource(-1));
        
        // Ensure only one toggle is active at a time
        healthToggle.addEventListener('change', function() {
            if (this.checked) {
                manaToggle.checked = false;
            } else {
                manaToggle.checked = true;
            }
        });
        
        manaToggle.addEventListener('change', function() {
            if (this.checked) {
                healthToggle.checked = false;
            } else {
                healthToggle.checked = true;
            }
        });
        
        // Event listener for reroll button
        rerollButton.addEventListener('click', reroll);
        
        // Initial roll
        reroll();
    </script>
</body>
</html>
